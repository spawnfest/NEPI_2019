!function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=5)}([function(t,e){"function"==typeof Object.create?t.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},function(t,e,n){t.exports=n(6),t.exports.Collection=n(2)},function(t,e,n){"use strict";t.exports.extend=function(t,e,n,r){var o=n.inverse;return Object.defineProperty(t,"remove",{value:function(t){var n=this.indexOf(t);return-1!==n&&(this.splice(n,1),e.unset(t,o,r)),t}}),Object.defineProperty(t,"contains",{value:function(t){return-1!==this.indexOf(t)}}),Object.defineProperty(t,"add",{value:function(t,n){var i=this.indexOf(t);if(void 0===n){if(-1!==i)return;n=this.length}-1!==i&&this.splice(i,1),this.splice(n,0,t),-1===i&&e.set(t,o,r)}}),Object.defineProperty(t,"__refs_collection",{value:!0}),t},t.exports.isExtended=function(t){return!0===t.__refs_collection}},function(t,e){"function"==typeof Object.create?t.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},function(t,e,n){"use strict";var r="hasOwnProperty",o=/,?([a-z]),?/gi,i=parseFloat,a=Math,c=a.PI,s=a.min,u=a.max,l=a.pow,h=a.abs,p=/([a-z])[\s,]*((-?\d*\.?\d*(?:e[-+]?\d+)?[\s]*,?[\s]*)+)/gi,d=/(-?\d*\.?\d*(?:e[-+]?\\d+)?)[\s]*,?[\s]*/gi;function f(t,e){return"finite"==(e=String.prototype.toLowerCase.call(e))?isFinite(t):!("array"!=e||!(t instanceof Array||Array.isArray&&Array.isArray(t)))||("null"==e&&null===t||e==typeof t&&null!==t||"object"==e&&t===Object(t)||Object.prototype.toString.call(t).slice(8,-1).toLowerCase()==e)}function v(t){if("function"==typeof t||Object(t)!==t)return t;var e=new t.constructor;for(var n in t)t[r](n)&&(e[n]=v(t[n]));return e}function y(t){var e=y.ps=y.ps||{};return e[t]?e[t].sleep=100:e[t]={sleep:100},setTimeout(function(){for(var n in e)e[r](n)&&n!=t&&(e[n].sleep--,!e[n].sleep&&delete e[n])}),e[t]}function g(t,e,n,r){return null==t&&(t=e=n=r=0),null==e&&(e=t.y,n=t.width,r=t.height,t=t.x),{x:t,y:e,width:n,w:n,height:r,h:r,x2:t+n,y2:e+r,cx:t+n/2,cy:e+r/2,r1:a.min(n,r)/2,r2:a.max(n,r)/2,r0:a.sqrt(n*n+r*r)/2,path:j(t,e,n,r),vb:[t,e,n,r].join(" ")}}function m(){return this.join(",").replace(o,"$1")}function x(t){var e=v(t);return e.toString=m,e}function _(t,e,n,r,o,i,s,u,h){var p=1-h,d=l(p,3),f=l(p,2),v=h*h,y=v*h,g=t+2*h*(n-t)+v*(o-2*n+t),m=e+2*h*(r-e)+v*(i-2*r+e),x=n+2*h*(o-n)+v*(s-2*o+n),_=r+2*h*(i-r)+v*(u-2*i+r);return{x:d*t+3*f*h*n+3*p*h*h*o+y*s,y:d*e+3*f*h*r+3*p*h*h*i+y*u,m:{x:g,y:m},n:{x:x,y:_},start:{x:p*t+h*n,y:p*e+h*r},end:{x:p*o+h*s,y:p*i+h*u},alpha:90-180*a.atan2(g-x,m-_)/c}}function w(t,e,n,r,o,i,c,l){f(t,"array")||(t=[t,e,n,r,o,i,c,l]);var p=function(t,e,n,r,o,i,c,l){for(var p,d,f,v,y,g,m,x,_=[],w=[[],[]],b=0;b<2;++b)if(0==b?(d=6*t-12*n+6*o,p=-3*t+9*n-9*o+3*c,f=3*n-3*t):(d=6*e-12*r+6*i,p=-3*e+9*r-9*i+3*l,f=3*r-3*e),h(p)<1e-12){if(h(d)<1e-12)continue;0<(v=-f/d)&&v<1&&_.push(v)}else m=d*d-4*f*p,x=a.sqrt(m),m<0||(0<(y=(-d+x)/(2*p))&&y<1&&_.push(y),0<(g=(-d-x)/(2*p))&&g<1&&_.push(g));var E,S=_.length,C=S;for(;S--;)v=_[S],E=1-v,w[0][S]=E*E*E*t+3*E*E*v*n+3*E*v*v*o+v*v*v*c,w[1][S]=E*E*E*e+3*E*E*v*r+3*E*v*v*i+v*v*v*l;return w[0][C]=t,w[1][C]=e,w[0][C+1]=c,w[1][C+1]=l,w[0].length=w[1].length=C+2,{min:{x:s.apply(0,w[0]),y:s.apply(0,w[1])},max:{x:u.apply(0,w[0]),y:u.apply(0,w[1])}}}.apply(null,t);return g(p.min.x,p.min.y,p.max.x-p.min.x,p.max.y-p.min.y)}function b(t,e,n){return e>=t.x&&e<=t.x+t.width&&n>=t.y&&n<=t.y+t.height}function E(t,e,n,r,o){return t*(t*(-3*e+9*n-9*r+3*o)+6*e-12*n+6*r)-3*e+3*n}function S(t,e,n,r,o,i,c,s,u){null==u&&(u=1);for(var l=(u=u>1?1:u<0?0:u)/2,h=[-.1252,.1252,-.3678,.3678,-.5873,.5873,-.7699,.7699,-.9041,.9041,-.9816,.9816],p=[.2491,.2491,.2335,.2335,.2032,.2032,.1601,.1601,.1069,.1069,.0472,.0472],d=0,f=0;f<12;f++){var v=l*h[f]+l,y=E(v,t,n,o,c),g=E(v,e,r,i,s),m=y*y+g*g;d+=p[f]*a.sqrt(m)}return l*d}function C(t,e,n,r,o,i,a,c){if(!(u(t,n)<s(o,a)||s(t,n)>u(o,a)||u(e,r)<s(i,c)||s(e,r)>u(i,c))){var l=(t-n)*(i-c)-(e-r)*(o-a);if(l){var h=((t*r-e*n)*(o-a)-(t-n)*(o*c-i*a))/l,p=((t*r-e*n)*(i-c)-(e-r)*(o*c-i*a))/l,d=+h.toFixed(2),f=+p.toFixed(2);if(!(d<+s(t,n).toFixed(2)||d>+u(t,n).toFixed(2)||d<+s(o,a).toFixed(2)||d>+u(o,a).toFixed(2)||f<+s(e,r).toFixed(2)||f>+u(e,r).toFixed(2)||f<+s(i,c).toFixed(2)||f>+u(i,c).toFixed(2)))return{x:h,y:p}}}}function k(t,e,n){if(!function(t,e){return t=g(t),b(e=g(e),t.x,t.y)||b(e,t.x2,t.y)||b(e,t.x,t.y2)||b(e,t.x2,t.y2)||b(t,e.x,e.y)||b(t,e.x2,e.y)||b(t,e.x,e.y2)||b(t,e.x2,e.y2)||(t.x<e.x2&&t.x>e.x||e.x<t.x2&&e.x>t.x)&&(t.y<e.y2&&t.y>e.y||e.y<t.y2&&e.y>t.y)}(w(t),w(e)))return n?0:[];for(var r=~~(S.apply(0,t)/5),o=~~(S.apply(0,e)/5),i=[],a=[],c={},s=n?0:[],u=0;u<r+1;u++){var l=_.apply(0,t.concat(u/r));i.push({x:l.x,y:l.y,t:u/r})}for(u=0;u<o+1;u++)l=_.apply(0,e.concat(u/o)),a.push({x:l.x,y:l.y,t:u/o});for(u=0;u<r;u++)for(var p=0;p<o;p++){var d=i[u],f=i[u+1],v=a[p],y=a[p+1],m=h(f.x-d.x)<.01?"y":"x",x=h(y.x-v.x)<.01?"y":"x",E=C(d.x,d.y,f.x,f.y,v.x,v.y,y.x,y.y);if(E){if(c[E.x.toFixed(0)]==E.y.toFixed(0))continue;c[E.x.toFixed(0)]=E.y.toFixed(0);var k=d.t+h((E[m]-d[m])/(f[m]-d[m]))*(f.t-d.t),j=v.t+h((E[x]-v[x])/(y[x]-v[x]))*(y.t-v.t);k>=0&&k<=1&&j>=0&&j<=1&&(n?s++:s.push({x:E.x,y:E.y,t1:k,t2:j}))}}return s}function j(t,e,n,r,o){if(o)return[["M",+t+ +o,e],["l",n-2*o,0],["a",o,o,0,0,1,o,o],["l",0,r-2*o],["a",o,o,0,0,1,-o,o],["l",2*o-n,0],["a",o,o,0,0,1,-o,-o],["l",0,2*o-r],["a",o,o,0,0,1,o,-o],["z"]];var i=[["M",t,e],["l",n,0],["l",0,r],["l",-n,0],["z"]];return i.toString=m,i}function M(t,e,n,r,o){if(null==o&&null==r&&(r=n),t=+t,e=+e,n=+n,r=+r,null!=o)var i=Math.PI/180,a=t+n*Math.cos(-r*i),c=t+n*Math.cos(-o*i),s=[["M",a,e+n*Math.sin(-r*i)],["A",n,n,0,+(o-r>180),0,c,e+n*Math.sin(-o*i)]];else s=[["M",t,e],["m",0,-r],["a",n,r,0,1,1,0,2*r],["a",n,r,0,1,1,0,-2*r],["z"]];return s.toString=m,s}function O(t){var e=y(t);if(e.abs)return x(e.abs);if(f(t,"array")&&f(t&&t[0],"array")||(t=function(t){if(!t)return null;var e=y(t);if(e.arr)return v(e.arr);var n={a:7,c:6,o:2,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,u:3,z:0},r=[];return f(t,"array")&&f(t[0],"array")&&(r=v(t)),r.length||String(t).replace(p,function(t,e,o){var i=[],a=e.toLowerCase();if(o.replace(d,function(t,e){e&&i.push(+e)}),"m"==a&&i.length>2&&(r.push([e].concat(i.splice(0,2))),a="l",e="m"==e?"l":"L"),"o"==a&&1==i.length&&r.push([e,i[0]]),"r"==a)r.push([e].concat(i));else for(;i.length>=n[a]&&(r.push([e].concat(i.splice(0,n[a]))),n[a]););}),r.toString=y.toString,e.arr=v(r),r}(t)),!t||!t.length)return[["M",0,0]];var n,r=[],o=0,i=0,a=0,c=0,s=0;"M"==t[0][0]&&(a=o=+t[0][1],c=i=+t[0][2],s++,r[0]=["M",o,i]);for(var u,l,h=3==t.length&&"M"==t[0][0]&&"R"==t[1][0].toUpperCase()&&"Z"==t[2][0].toUpperCase(),g=s,_=t.length;g<_;g++){if(r.push(u=[]),(n=(l=t[g])[0])!=n.toUpperCase())switch(u[0]=n.toUpperCase(),u[0]){case"A":u[1]=l[1],u[2]=l[2],u[3]=l[3],u[4]=l[4],u[5]=l[5],u[6]=+l[6]+o,u[7]=+l[7]+i;break;case"V":u[1]=+l[1]+i;break;case"H":u[1]=+l[1]+o;break;case"R":for(var w=[o,i].concat(l.slice(1)),b=2,E=w.length;b<E;b++)w[b]=+w[b]+o,w[++b]=+w[b]+i;r.pop(),r=r.concat(A(w,h));break;case"O":r.pop(),(w=M(o,i,l[1],l[2])).push(w[0]),r=r.concat(w);break;case"U":r.pop(),r=r.concat(M(o,i,l[1],l[2],l[3])),u=["U"].concat(r[r.length-1].slice(-2));break;case"M":a=+l[1]+o,c=+l[2]+i;default:for(b=1,E=l.length;b<E;b++)u[b]=+l[b]+(b%2?o:i)}else if("R"==n)w=[o,i].concat(l.slice(1)),r.pop(),r=r.concat(A(w,h)),u=["R"].concat(l.slice(-2));else if("O"==n)r.pop(),(w=M(o,i,l[1],l[2])).push(w[0]),r=r.concat(w);else if("U"==n)r.pop(),r=r.concat(M(o,i,l[1],l[2],l[3])),u=["U"].concat(r[r.length-1].slice(-2));else for(var S=0,C=l.length;S<C;S++)u[S]=l[S];if("O"!=(n=n.toUpperCase()))switch(u[0]){case"Z":o=+a,i=+c;break;case"H":o=u[1];break;case"V":i=u[1];break;case"M":a=u[u.length-2],c=u[u.length-1];default:o=u[u.length-2],i=u[u.length-1]}}return r.toString=m,e.abs=x(r),r}function P(t,e,n,r){return[t,e,n,r,n,r]}function B(t,e,n,r,o,i){return[1/3*t+2/3*n,1/3*e+2/3*r,1/3*o+2/3*n,1/3*i+2/3*r,o,i]}function R(t,e,n,o,i,s,u,l,p,d){var f,v,y,g,m=120*c/180,x=c/180*(+i||0),_=[],w=(v=function(t,e,n){return{x:t*a.cos(n)-e*a.sin(n),y:t*a.sin(n)+e*a.cos(n)}},function t(){var e=Array.prototype.slice.call(arguments,0),n=e.join("â€"),o=t.cache=t.cache||{},i=t.count=t.count||[];return o[r](n)?(function(t,e){for(var n=0,r=t.length;n<r;n++)if(t[n]===e)return t.push(t.splice(n,1)[0])}(i,n),g?g(o[n]):o[n]):(i.length>=1e3&&delete o[i.shift()],i.push(n),o[n]=v.apply(y,e),g?g(o[n]):o[n])});if(d)P=d[0],B=d[1],M=d[2],O=d[3];else{t=(f=w(t,e,-x)).x,e=f.y;var b=(t-(l=(f=w(l,p,-x)).x))/2,E=(e-(p=f.y))/2,S=b*b/(n*n)+E*E/(o*o);S>1&&(n*=S=a.sqrt(S),o*=S);var C=n*n,k=o*o,j=(s==u?-1:1)*a.sqrt(h((C*k-C*E*E-k*b*b)/(C*E*E+k*b*b))),M=j*n*E/o+(t+l)/2,O=j*-o*b/n+(e+p)/2,P=a.asin(((e-O)/o).toFixed(9)),B=a.asin(((p-O)/o).toFixed(9));(P=t<M?c-P:P)<0&&(P=2*c+P),(B=l<M?c-B:B)<0&&(B=2*c+B),u&&P>B&&(P-=2*c),!u&&B>P&&(B-=2*c)}var A=B-P;if(h(A)>m){var z=B,T=l,$=p;B=P+m*(u&&B>P?1:-1),_=R(l=M+n*a.cos(B),p=O+o*a.sin(B),n,o,i,0,u,T,$,[B,z,M,O])}A=B-P;var L=a.cos(P),D=a.sin(P),N=a.cos(B),F=a.sin(B),H=a.tan(A/4),G=4/3*n*H,I=4/3*o*H,V=[t,e],q=[t+G*D,e-I*L],W=[l+G*F,p-I*N],U=[l,p];if(q[0]=2*V[0]-q[0],q[1]=2*V[1]-q[1],d)return[q,W,U].concat(_);for(var Y=[],K=0,X=(_=[q,W,U].concat(_).join().split(",")).length;K<X;K++)Y[K]=K%2?w(_[K-1],_[K],x).y:w(_[K],_[K+1],x).x;return Y}function A(t,e){for(var n=[],r=0,o=t.length;o-2*!e>r;r+=2){var i=[{x:+t[r-2],y:+t[r-1]},{x:+t[r],y:+t[r+1]},{x:+t[r+2],y:+t[r+3]},{x:+t[r+4],y:+t[r+5]}];e?r?o-4==r?i[3]={x:+t[0],y:+t[1]}:o-2==r&&(i[2]={x:+t[0],y:+t[1]},i[3]={x:+t[2],y:+t[3]}):i[0]={x:+t[o-2],y:+t[o-1]}:o-4==r?i[3]=i[2]:r||(i[0]={x:+t[r],y:+t[r+1]}),n.push(["C",(-i[0].x+6*i[1].x+i[2].x)/6,(-i[0].y+6*i[1].y+i[2].y)/6,(i[1].x+6*i[2].x-i[3].x)/6,(i[1].y+6*i[2].y-i[3].y)/6,i[2].x,i[2].y])}return n}function z(t,e){var n=!e&&y(t);if(!e&&n.curve)return x(n.curve);for(var r=O(t),o=e&&O(e),a={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},c={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},s=function(t,e,n){var r,o;if(!t)return["C",e.x,e.y,e.x,e.y,e.x,e.y];switch(!(t[0]in{T:1,Q:1})&&(e.qx=e.qy=null),t[0]){case"M":e.X=t[1],e.Y=t[2];break;case"A":t=["C"].concat(R.apply(0,[e.x,e.y].concat(t.slice(1))));break;case"S":"C"==n||"S"==n?(r=2*e.x-e.bx,o=2*e.y-e.by):(r=e.x,o=e.y),t=["C",r,o].concat(t.slice(1));break;case"T":"Q"==n||"T"==n?(e.qx=2*e.x-e.qx,e.qy=2*e.y-e.qy):(e.qx=e.x,e.qy=e.y),t=["C"].concat(B(e.x,e.y,e.qx,e.qy,t[1],t[2]));break;case"Q":e.qx=t[1],e.qy=t[2],t=["C"].concat(B(e.x,e.y,t[1],t[2],t[3],t[4]));break;case"L":t=["C"].concat(P(e.x,e.y,t[1],t[2]));break;case"H":t=["C"].concat(P(e.x,e.y,t[1],e.y));break;case"V":t=["C"].concat(P(e.x,e.y,e.x,t[1]));break;case"Z":t=["C"].concat(P(e.x,e.y,e.X,e.Y))}return t},l=function(t,e){if(t[e].length>7){t[e].shift();for(var n=t[e];n.length;)p[e]="A",o&&(d[e]="A"),t.splice(e++,0,["C"].concat(n.splice(0,6)));t.splice(e,1),m=u(r.length,o&&o.length||0)}},h=function(t,e,n,i,a){t&&e&&"M"==t[a][0]&&"M"!=e[a][0]&&(e.splice(a,0,["M",i.x,i.y]),n.bx=0,n.by=0,n.x=t[a][1],n.y=t[a][2],m=u(r.length,o&&o.length||0))},p=[],d=[],f="",v="",g=0,m=u(r.length,o&&o.length||0);g<m;g++){r[g]&&(f=r[g][0]),"C"!=f&&(p[g]=f,g&&(v=p[g-1])),r[g]=s(r[g],a,v),"A"!=p[g]&&"C"==f&&(p[g]="C"),l(r,g),o&&(o[g]&&(f=o[g][0]),"C"!=f&&(d[g]=f,g&&(v=d[g-1])),o[g]=s(o[g],c,v),"A"!=d[g]&&"C"==f&&(d[g]="C"),l(o,g)),h(r,o,a,c,g),h(o,r,c,a,g);var _=r[g],w=o&&o[g],b=_.length,E=o&&w.length;a.x=_[b-2],a.y=_[b-1],a.bx=i(_[b-4])||a.x,a.by=i(_[b-3])||a.y,c.bx=o&&(i(w[E-4])||c.x),c.by=o&&(i(w[E-3])||c.y),c.x=o&&w[E-2],c.y=o&&w[E-1]}return o||(n.curve=x(r)),o?[r,o]:r}t.exports=function(t,e,n){t=z(t),e=z(e);for(var r,o,i,a,c,s,u,l,h,p,d=n?0:[],f=0,v=t.length;f<v;f++){var y=t[f];if("M"==y[0])r=c=y[1],o=s=y[2];else{"C"==y[0]?(h=[r,o].concat(y.slice(1)),r=h[6],o=h[7]):(h=[r,o,r,o,c,s,c,s],r=c,o=s);for(var g=0,m=e.length;g<m;g++){var x=e[g];if("M"==x[0])i=u=x[1],a=l=x[2];else{"C"==x[0]?(p=[i,a].concat(x.slice(1)),i=p[6],a=p[7]):(p=[i,a,i,a,u,l,u,l],i=u,a=l);var _=k(h,p,n);if(n)d+=_;else{for(var w=0,b=_.length;w<b;w++)_[w].segment1=f,_[w].segment2=g,_[w].bez1=h,_[w].bez2=p;d=d.concat(_)}}}}}return d}},function(t,e,n){t.exports=n(7)},function(t,e,n){"use strict";var r=n(2);function o(t,e,n){var o=r.extend(n[e.name]||[],t,e,n);Object.defineProperty(n,e.name,{enumerable:e.enumerable,value:o}),o.length&&o.forEach(function(r){t.set(r,e.inverse,n)})}function i(t,e){if(!(this instanceof i))return new i(t,e);t.inverse=e,e.inverse=t,this.props={},this.props[t.name]=t,this.props[e.name]=e}i.prototype.bind=function(t,e){if("string"==typeof e){if(!this.props[e])throw new Error("no property <"+e+"> in ref");e=this.props[e]}e.collection?o(this,e,t):function(t,e,n){var r=e.inverse,o=n[e.name];Object.defineProperty(n,e.name,{configurable:e.configurable,enumerable:e.enumerable,get:function(){return o},set:function(e){if(e!==o){var i=o;o=null,i&&t.unset(i,r,n),o=e,t.set(o,r,n)}}})}(this,e,t)},i.prototype.ensureRefsCollection=function(t,e){var n=t[e.name];return r.isExtended(n)||o(this,e,t),n},i.prototype.ensureBound=function(t,e){(function(t,e){return Object.prototype.hasOwnProperty.call(t,e.name||e)})(t,e)||this.bind(t,e)},i.prototype.unset=function(t,e,n){t&&(this.ensureBound(t,e),e.collection?this.ensureRefsCollection(t,e).remove(n):t[e.name]=void 0)},i.prototype.set=function(t,e,n){t&&(this.ensureBound(t,e),e.collection?this.ensureRefsCollection(t,e).add(n):t[e.name]=n)},t.exports=i},function(t,e,n){"use strict";n.r(e);var r=/^class /;function o(t){return"[object Array]"===Object.prototype.toString.call(t)}function i(){var t=Array.prototype.slice.call(arguments);1===t.length&&o(t[0])&&(t=t[0]);var e=t.pop();return e.$inject=t,e}var a=/constructor\s*[^(]*\(\s*([^)]*)\)/m,c=/^function\s*[^(]*\(\s*([^)]*)\)/m,s=/\/\*([^*]*)\*\//m;function u(t){if("function"!=typeof t)throw new Error('Cannot annotate "'+t+'". Expected a function!');var e=t.toString().match(function(t){return r.test(t.toString())}(t)?a:c);return e&&e[1]&&e[1].split(",").map(function(t){return(e=t.match(s))?e[1].trim():t.trim()})||[]}var l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};function h(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function p(t,e){e=e||{get:function(t,e){if(n.push(t),!1===e)return null;throw s('No provider for "'+t+'"!')}};var n=[],r=this._providers=Object.create(e._providers||null),a=this._instances=Object.create(null),c=a.injector=this,s=function(t){var e=n.join(" -> ");return n.length=0,new Error(e?t+" (Resolving: "+e+")":t)},f=function t(o,i){if(!r[o]&&-1!==o.indexOf(".")){for(var c=o.split("."),u=t(c.shift());c.length;)u=u[c.shift()];return u}if(d(a,o))return a[o];if(d(r,o)){if(-1!==n.indexOf(o))throw n.push(o),s("Cannot resolve circular dependency!");return n.push(o),a[o]=r[o][0](r[o][1]),n.pop(),a[o]}return e.get(o,i)},v=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("function"!=typeof t){if(!o(t))throw new Error('Cannot invoke "'+t+'". Expected a function!');t=i(t.slice())}return{fn:t,dependencies:(t.$inject||u(t)).map(function(t){return d(e,t)?e[t]:f(t)})}},y=function(t){var e=v(t),n=e.dependencies,r=e.fn;return new(Function.prototype.bind.apply(r,[null].concat(h(n))))},g=function(t,e,n){var r=v(t,n),o=r.dependencies,i=r.fn;return i.call.apply(i,[e].concat(h(o)))},m=function(t){return i(function(e){return t.get(e)})},x={factory:g,type:y,value:function(t){return t}};t.forEach(function(t){function e(t,e){return"value"!==t&&o(e)&&(e=i(e.slice())),e}if(t instanceof function(){var t=[];this.factory=function(e,n){return t.push([e,"factory",n]),this},this.value=function(e,n){return t.push([e,"value",n]),this},this.type=function(e,n){return t.push([e,"type",n]),this},this.forEach=function(e){t.forEach(e)}})t.forEach(function(t){var n=t[0],o=t[1],i=t[2];r[n]=[x[o],e(o,i),o]});else if("object"===(void 0===t?"undefined":l(t)))if(t.__exports__){var n=Object.keys(t).reduce(function(e,n){return"__"!==n.substring(0,2)&&(e[n]=t[n]),e},Object.create(null)),a=new p((t.__modules__||[]).concat([n]),c),s=i(function(t){return a.get(t)});t.__exports__.forEach(function(t){r[t]=[s,t,"private",a]})}else Object.keys(t).forEach(function(n){if("private"!==t[n][2]){var o=t[n][0],i=t[n][1];r[n]=[x[o],e(o,i),o]}else r[n]=t[n]})}),this.get=f,this.invoke=g,this.instantiate=y,this.createChild=function(t,e){if(e&&e.length){var n,o,i,a,s=Object.create(null),u=Object.create(null),l=[],h=[],d=[];for(var f in r)n=r[f],-1!==e.indexOf(f)&&("private"===n[2]?-1===(o=l.indexOf(n[3]))?(i=n[3].createChild([],e),a=m(i),l.push(n[3]),h.push(i),d.push(a),s[f]=[a,f,"private",i]):s[f]=[d[o],f,"private",h[o]]:s[f]=[n[2],n[1]],u[f]=!0),"factory"!==n[2]&&"type"!==n[2]||!n[1].$scope||e.forEach(function(t){-1!==n[1].$scope.indexOf(t)&&(s[f]=[n[2],n[1]],u[t]=!0)});e.forEach(function(t){if(!u[t])throw new Error('No provider for "'+t+'". Cannot use provider from the parent!')}),t.unshift(s)}return new p(t,c)}}function d(t,e){return Object.hasOwnProperty.call(t,e)}var f=n(0),v=n.n(f),y=1e3;function g(t,e){var n=this;e=e||y,t.on(["render.shape","render.connection"],e,function(t,e){var r=t.type,o=e.element,i=e.gfx;if(n.canRender(o))return"render.shape"===r?n.drawShape(i,o):n.drawConnection(i,o)}),t.on(["render.getShapePath","render.getConnectionPath"],e,function(t,e){if(n.canRender(e))return"render.getShapePath"===t.type?n.getShapePath(e):n.getConnectionPath(e)})}function m(t,e){if(t.ownerDocument!==e.ownerDocument)try{return e.ownerDocument.importNode(t,!0)}catch(t){}return t}function x(t,e){return e.appendChild(m(t,e))}function _(t,e){return x(e,t),t}g.prototype.canRender=function(){},g.prototype.drawShape=function(){},g.prototype.drawConnection=function(){},g.prototype.getShapePath=function(){},g.prototype.getConnectionPath=function(){};var w=2,b={"alignment-baseline":1,"baseline-shift":1,clip:1,"clip-path":1,"clip-rule":1,color:1,"color-interpolation":1,"color-interpolation-filters":1,"color-profile":1,"color-rendering":1,cursor:1,direction:1,display:1,"dominant-baseline":1,"enable-background":1,fill:1,"fill-opacity":1,"fill-rule":1,filter:1,"flood-color":1,"flood-opacity":1,font:1,"font-family":1,"font-size":w,"font-size-adjust":1,"font-stretch":1,"font-style":1,"font-variant":1,"font-weight":1,"glyph-orientation-horizontal":1,"glyph-orientation-vertical":1,"image-rendering":1,kerning:1,"letter-spacing":1,"lighting-color":1,marker:1,"marker-end":1,"marker-mid":1,"marker-start":1,mask:1,opacity:1,overflow:1,"pointer-events":1,"shape-rendering":1,"stop-color":1,"stop-opacity":1,stroke:1,"stroke-dasharray":1,"stroke-dashoffset":1,"stroke-linecap":1,"stroke-linejoin":1,"stroke-miterlimit":1,"stroke-opacity":1,"stroke-width":w,"text-anchor":1,"text-decoration":1,"text-rendering":1,"unicode-bidi":1,visibility:1,"word-spacing":1,"writing-mode":1};function E(t,e,n){var r=e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),o=b[r];o?(o===w&&"number"==typeof n&&(n=String(n)+"px"),t.style[r]=n):t.setAttributeNS(null,e,n)}function S(t,e,n){if("string"==typeof e){if(void 0===n)return function(t,e){return b[e]?t.style[e]:t.getAttributeNS(null,e)}(t,e);E(t,e,n)}else!function(t,e){var n,r,o=Object.keys(e);for(n=0;r=o[n];n++)E(t,r,e[r])}(t,e);return t}function C(t,e){if(t.indexOf)return t.indexOf(e);for(var n=0;n<t.length;++n)if(t[n]===e)return n;return-1}var k=/\s+/,j=Object.prototype.toString;function M(t){return void 0!==t}function O(t){return new P(t)}function P(t){if(!t||!t.nodeType)throw new Error("A DOM element reference is required");this.el=t,this.list=t.classList}function B(t){var e=t.parentNode;return e&&e.removeChild(t),t}function R(t){for(var e;e=t.firstChild;)B(e);return t}function A(t){return t.cloneNode(!0)}P.prototype.add=function(t){if(this.list)return this.list.add(t),this;var e=this.array();return~C(e,t)||e.push(t),M(this.el.className.baseVal)?this.el.className.baseVal=e.join(" "):this.el.className=e.join(" "),this},P.prototype.remove=function(t){if("[object RegExp]"===j.call(t))return this.removeMatching(t);if(this.list)return this.list.remove(t),this;var e=this.array(),n=C(e,t);return~n&&e.splice(n,1),this.el.className.baseVal=e.join(" "),this},P.prototype.removeMatching=function(t){for(var e=this.array(),n=0;n<e.length;n++)t.test(e[n])&&this.remove(e[n]);return this},P.prototype.toggle=function(t,e){return this.list?(M(e)?e!==this.list.toggle(t,e)&&this.list.toggle(t):this.list.toggle(t),this):(M(e)?e?this.add(t):this.remove(t):this.has(t)?this.remove(t):this.add(t),this)},P.prototype.array=function(){var t=(this.el.getAttribute("class")||"").replace(/^\s+|\s+$/g,"").split(k);return""===t[0]&&t.shift(),t},P.prototype.has=P.prototype.contains=function(t){return this.list?this.list.contains(t):!!~C(this.array(),t)};var z={svg:"http://www.w3.org/2000/svg"},T='<svg xmlns="'+z.svg+'"';function $(t){var e=!1;"<svg"===t.substring(0,4)?-1===t.indexOf(z.svg)&&(t=T+t.substring(4)):(t=T+">"+t+"</svg>",e=!0);var n=function(t){var e;return(e=new DOMParser).async=!1,e.parseFromString(t,"text/xml")}(t);if(!e)return n;for(var r=document.createDocumentFragment(),o=n.firstChild;o.firstChild;)r.appendChild(o.firstChild);return r}function L(t,e){var n;return"<"===t.charAt(0)?(n=$(t).firstChild,n=document.importNode(n,!0)):n=document.createElementNS(z.svg,t),e&&S(n,e),n}var D=L("svg");function N(t,e){var n,r,o=Object.keys(e);for(n=0;r=o[n];n++)t[r]=e[r];return t}function F(t){return t?D.createSVGTransformFromMatrix(t):D.createSVGTransform()}function H(t,e){return e instanceof SVGMatrix?t.createSVGTransformFromMatrix(e):e}function G(t,e){var n=t.transform.baseVal;return e&&(Array.isArray(e)||(e=[e]),function(t,e){var n,r;for(t.clear(),n=0;r=e[n];n++)t.appendItem(H(t,r))}(n,e)),n.consolidate()}function I(t){return t.join(",").replace(/,?([A-z]),?/g,"$1")}function V(t){for(var e,n="",r=0;e=t[r];r++)n+=e.x+","+e.y+" ";return n}function q(t,e){var n=L("polyline");return S(n,{points:V(t)}),e&&S(n,e),n}function W(t){return Array.prototype.concat.apply([],t)}var U=Object.prototype.toString,Y=Object.prototype.hasOwnProperty;function K(t){return void 0===t}function X(t){return void 0!==t}function Z(t){return"[object Array]"===U.call(t)}function Q(t){return"[object Object]"===U.call(t)}function J(t){return"[object Number]"===U.call(t)}function tt(t){var e=U.call(t);return"[object Function]"===e||"[object AsyncFunction]"===e||"[object GeneratorFunction]"===e||"[object AsyncGeneratorFunction]"===e||"[object Proxy]"===e}function et(t){return"[object String]"===U.call(t)}function nt(t,e){return Y.call(t,e)}function rt(t,e){var n;return e=yt(e),it(t,function(t,r){if(e(t,r))return n=t,!1}),n}function ot(t,e){var n=[];return it(t,function(t,r){e(t,r)&&n.push(t)}),n}function it(t,e){var n;if(!K(t)){var r=Z(t)?mt:gt;for(var o in t)if(nt(t,o)&&!1===e(n=t[o],r(o)))return n}}function at(t,e,n){return it(t,function(t,r){n=e(n,t,r)}),n}function ct(t,e){return at(t,function(t,n,r){return t&&e(n,r)},!0)}function st(t,e){var n=[];return it(t,function(t,r){n.push(e(t,r))}),n}function ut(t){return function(t){return t&&Object.keys(t)||[]}(t).length}function lt(t){return st(t,function(t){return t})}function ht(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return e=vt(e),it(t,function(t){var r=e(t)||"_",o=n[r];o||(o=n[r]=[]),o.push(t)}),n}function pt(t){t=vt(t);for(var e={},n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return it(r,function(n){return ht(n,t,e)}),st(e,function(t,e){return t[0]})}function dt(t,e){e=vt(e);var n=[];return it(t,function(t,r){for(var o=e(t,r),i={d:o,v:t},a=0;a<n.length;a++){if(o<n[a].d)return void n.splice(a,0,i)}n.push(i)}),st(n,function(t){return t.v})}function ft(t){return function(e){return ct(t,function(t,n){return e[n]===t})}}function vt(t){return tt(t)?t:function(e){return e[t]}}function yt(t){return tt(t)?t:function(e){return e===t}}function gt(t){return t}function mt(t){return Number(t)}function xt(t,e){return t.bind(e)}function _t(){return(_t=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function wt(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return _t.apply(void 0,[t].concat(n))}function bt(t,e){var n={},r=Object(t);return it(e,function(e){e in r&&(n[e]=t[e])}),n}function Et(t){return ot(t,function(e){return!rt(t,function(t){return t!==e&&function t(e,n){if(!n)return;if(e===n)return n;if(!e.parent)return;return t(e.parent,n)}(e,t)})})}function St(t,e,n){var r=!n||-1===t.indexOf(e);return r&&t.push(e),r}function Ct(t,e,n){n=n||0,Z(t)||(t=[t]),it(t,function(t,r){var o=e(t,r,n);Z(o)&&o.length&&Ct(o,e,n+1)})}function kt(t,e,n){var r=[],o=[];return Ct(t,function(t,i,a){St(r,t,e);var c=t.children;if((-1===n||a<n)&&c&&St(o,c,e))return c}),r}function jt(t,e){var n,r,o,i;return e=!!e,Z(t)||(t=[t]),it(t,function(t){var a=t;t.waypoints&&!e&&(a=jt(t.waypoints,!0));var c=a.x,s=a.y,u=a.height||0,l=a.width||0;(c<n||void 0===n)&&(n=c),(s<r||void 0===r)&&(r=s),(c+l>o||void 0===o)&&(o=c+l),(s+u>i||void 0===i)&&(i=s+u)}),{x:n,y:r,height:i-r,width:o-n}}function Mt(t){return"waypoints"in t?"connection":"x"in t?"shape":"root"}function Ot(t){return!(!t||!t.isFrame)}function Pt(t,e){return wt({},t||{},e||{})}var Bt=1;function Rt(t,e){g.call(this,t,Bt),this.CONNECTION_STYLE=e.style(["no-fill"],{strokeWidth:5,stroke:"fuchsia"}),this.SHAPE_STYLE=e.style({fill:"white",stroke:"fuchsia",strokeWidth:2}),this.FRAME_STYLE=e.style(["no-fill"],{stroke:"fuchsia",strokeDasharray:4,strokeWidth:2})}v()(Rt,g),Rt.prototype.canRender=function(){return!0},Rt.prototype.drawShape=function(t,e){var n=L("rect");return S(n,{x:0,y:0,width:e.width||0,height:e.height||0}),Ot(e)?S(n,this.FRAME_STYLE):S(n,this.SHAPE_STYLE),_(t,n),n},Rt.prototype.drawConnection=function(t,e){var n=q(e.waypoints,this.CONNECTION_STYLE);return _(t,n),n},Rt.prototype.getShapePath=function(t){var e=t.x,n=t.y,r=t.width;return I([["M",e,n],["l",r,0],["l",0,t.height],["l",-r,0],["z"]])},Rt.prototype.getConnectionPath=function(t){var e,n,r=t.waypoints,o=[];for(e=0;n=r[e];e++)n=n.original||n,o.push([0===e?"M":"L",n.x,n.y]);return I(o)},Rt.$inject=["eventBus","styles"];var At={__init__:["defaultRenderer"],defaultRenderer:["type",Rt],styles:["type",function(){var t={"no-fill":{fill:"none"},"no-border":{strokeOpacity:0},"no-events":{pointerEvents:"none"}},e=this;this.cls=function(t,e,n){return wt(this.style(e,n),{class:t})},this.style=function(e,n){Z(e)||n||(n=e,e=[]);var r=at(e,function(e,n){return wt(e,t[n]||{})},{});return n?wt(r,n):r},this.computeStyle=function(t,n,r){return Z(n)||(r=n,n=[]),e.style(n||[],wt({},r,t||{}))}}]};function zt(t,e){if(!t||!e)return-1;var n=t.indexOf(e);return-1!==n&&t.splice(n,1),n}function Tt(t,e,n){if(t&&e){"number"!=typeof n&&(n=-1);var r=t.indexOf(e);if(-1!==r){if(r===n)return;if(-1===n)return;t.splice(r,1)}-1!==n?t.splice(n,0,e):t.push(e)}}function $t(t,e){return t&&e?t.indexOf(e):-1}function Lt(t,e){return Math.round(t*e)/e}function Dt(t){return J(t)?t+"px":t}function Nt(t,e,n){var r=L("g");O(r).add(e);var o=void 0!==n?n:t.childNodes.length-1;return t.insertBefore(r,t.childNodes[o]||null),r}var Ft={shape:["x","y","width","height"],connection:["waypoints"]};function Ht(t,e,n,r){this._eventBus=e,this._elementRegistry=r,this._graphicsFactory=n,this._init(t||{})}function Gt(t,e){var n="matrix("+e.a+","+e.b+","+e.c+","+e.d+","+e.e+","+e.f+")";t.setAttribute("transform",n)}Ht.$inject=["config.canvas","eventBus","graphicsFactory","elementRegistry"],Ht.prototype._init=function(t){var e=this._eventBus,n=this._container=function(t){var e=(t=wt({},{width:"100%",height:"100%"},t)).container||document.body,n=document.createElement("div");return n.setAttribute("class","djs-container"),wt(n.style,{position:"relative",overflow:"hidden",width:Dt(t.width),height:Dt(t.height)}),e.appendChild(n),n}(t),r=this._svg=L("svg");S(r,{width:"100%",height:"100%"}),_(n,r);var o=this._viewport=Nt(r,"viewport");this._layers={},!1!==t.deferUpdate&&(this._viewboxChanged=function(t,e){var n,r,o,i;function a(){var a=Date.now(),s=i+e-a;if(s>0)return c(s);t.apply(o,r),n=i=r=o=void 0}function c(t){n=setTimeout(a,t)}return function(){i=Date.now();for(var t=arguments.length,a=new Array(t),s=0;s<t;s++)a[s]=arguments[s];r=a,o=this,n||c(e)}}(xt(this._viewboxChanged,this),300)),e.on("diagram.init",function(){e.fire("canvas.init",{svg:r,viewport:o})},this),e.on(["shape.added","connection.added","shape.removed","connection.removed","elements.changed"],function(){delete this._cachedViewbox},this),e.on("diagram.destroy",500,this._destroy,this),e.on("diagram.clear",500,this._clear,this)},Ht.prototype._destroy=function(t){this._eventBus.fire("canvas.destroy",{svg:this._svg,viewport:this._viewport});var e=this._container.parentNode;e&&e.removeChild(this._container),delete this._svg,delete this._container,delete this._layers,delete this._rootElement,delete this._viewport},Ht.prototype._clear=function(){var t=this;this._elementRegistry.getAll().forEach(function(e){var n=Mt(e);"root"===n?t.setRootElement(null,!0):t._removeElement(e,n)}),delete this._cachedViewbox},Ht.prototype.getDefaultLayer=function(){return this.getLayer("base",0)},Ht.prototype.getLayer=function(t,e){if(!t)throw new Error("must specify a name");var n=this._layers[t];if(n||(n=this._layers[t]=this._createLayer(t,e)),void 0!==e&&n.index!==e)throw new Error("layer <"+t+"> already created at index <"+e+">");return n.group},Ht.prototype._createLayer=function(t,e){e||(e=0);var n=at(this._layers,function(t,n){return e>=n.index&&t++,t},0);return{group:Nt(this._viewport,"layer-"+t,n),index:e}},Ht.prototype.getContainer=function(){return this._container},Ht.prototype._updateMarker=function(t,e,n){var r;t.id||(t=this._elementRegistry.get(t)),(r=this._elementRegistry._elements[t.id])&&(it([r.gfx,r.secondaryGfx],function(t){t&&(n?O(t).add(e):O(t).remove(e))}),this._eventBus.fire("element.marker.update",{element:t,gfx:r.gfx,marker:e,add:!!n}))},Ht.prototype.addMarker=function(t,e){this._updateMarker(t,e,!0)},Ht.prototype.removeMarker=function(t,e){this._updateMarker(t,e,!1)},Ht.prototype.hasMarker=function(t,e){return t.id||(t=this._elementRegistry.get(t)),O(this.getGraphics(t)).has(e)},Ht.prototype.toggleMarker=function(t,e){this.hasMarker(t,e)?this.removeMarker(t,e):this.addMarker(t,e)},Ht.prototype.getRootElement=function(){return this._rootElement||this.setRootElement({id:"__implicitroot",children:[]}),this._rootElement},Ht.prototype.setRootElement=function(t,e){t&&this._ensureValid("root",t);var n=this._rootElement,r=this._elementRegistry,o=this._eventBus;if(n){if(!e)throw new Error("rootElement already set, need to specify override");o.fire("root.remove",{element:n}),o.fire("root.removed",{element:n}),r.remove(n)}if(t){var i=this.getDefaultLayer();o.fire("root.add",{element:t}),r.add(t,i,this._svg),o.fire("root.added",{element:t,gfx:i})}return this._rootElement=t,t},Ht.prototype._ensureValid=function(t,e){if(!e.id)throw new Error("element must have an id");if(this._elementRegistry.get(e.id))throw new Error("element with id "+e.id+" already exists");var n=Ft[t];if(!ct(n,function(t){return void 0!==e[t]}))throw new Error("must supply { "+n.join(", ")+" } with "+t)},Ht.prototype._setParent=function(t,e,n){Tt(e.children,t,n),t.parent=e},Ht.prototype._addElement=function(t,e,n,r){n=n||this.getRootElement();var o=this._eventBus,i=this._graphicsFactory;this._ensureValid(t,e),o.fire(t+".add",{element:e,parent:n}),this._setParent(e,n,r);var a=i.create(t,e,r);return this._elementRegistry.add(e,a),i.update(t,e,a),o.fire(t+".added",{element:e,gfx:a}),e},Ht.prototype.addShape=function(t,e,n){return this._addElement("shape",t,e,n)},Ht.prototype.addConnection=function(t,e,n){return this._addElement("connection",t,e,n)},Ht.prototype._removeElement=function(t,e){var n=this._elementRegistry,r=this._graphicsFactory,o=this._eventBus;if(t=n.get(t.id||t))return o.fire(e+".remove",{element:t}),r.remove(t),zt(t.parent&&t.parent.children,t),t.parent=null,o.fire(e+".removed",{element:t}),n.remove(t),t},Ht.prototype.removeShape=function(t){return this._removeElement(t,"shape")},Ht.prototype.removeConnection=function(t){return this._removeElement(t,"connection")},Ht.prototype.getGraphics=function(t,e){return this._elementRegistry.getGraphics(t,e)},Ht.prototype._changeViewbox=function(t){this._eventBus.fire("canvas.viewbox.changing"),t.apply(this),this._cachedViewbox=null,this._viewboxChanged()},Ht.prototype._viewboxChanged=function(){this._eventBus.fire("canvas.viewbox.changed",{viewbox:this.viewbox()})},Ht.prototype.viewbox=function(t){if(void 0===t&&this._cachedViewbox)return this._cachedViewbox;var e,n,r,o,i,a,c=this._viewport,s=this.getSize();return t?(this._changeViewbox(function(){o=Math.min(s.width/t.width,s.height/t.height);var e=this._svg.createSVGMatrix().scale(o).translate(-t.x,-t.y);G(c,e)}),t):(e=this.getDefaultLayer().getBBox(),n=(r=G(c))?r.matrix:function(t,e,n,r,o,i){var a=D.createSVGMatrix();switch(arguments.length){case 0:return a;case 1:return N(a,t);case 6:return N(a,{a:t,b:e,c:n,d:r,e:o,f:i})}}(),o=Lt(n.a,1e3),i=Lt(-n.e||0,1e3),a=Lt(-n.f||0,1e3),t=this._cachedViewbox={x:i?i/o:0,y:a?a/o:0,width:s.width/o,height:s.height/o,scale:o,inner:{width:e.width,height:e.height,x:e.x,y:e.y},outer:s})},Ht.prototype.scroll=function(t){var e=this._viewport,n=e.getCTM();return t&&this._changeViewbox(function(){t=wt({dx:0,dy:0},t||{}),n=this._svg.createSVGMatrix().translate(t.dx,t.dy).multiply(n),Gt(e,n)}),{x:n.e,y:n.f}},Ht.prototype.zoom=function(t,e){return t?"fit-viewport"===t?this._fitViewport(e):(this._changeViewbox(function(){"object"!=typeof e&&(n=this.viewbox().outer,e={x:n.width/2,y:n.height/2}),r=this._setZoom(t,e)}),Lt(r.a,1e3)):this.viewbox(t).scale;var n,r},Ht.prototype._fitViewport=function(t){var e,n,r=this.viewbox(),o=r.outer,i=r.inner;return i.x>=0&&i.y>=0&&i.x+i.width<=o.width&&i.y+i.height<=o.height&&!t?n={x:0,y:0,width:Math.max(i.width+i.x,o.width),height:Math.max(i.height+i.y,o.height)}:(e=Math.min(1,o.width/i.width,o.height/i.height),n={x:i.x+(t?i.width/2-o.width/e/2:0),y:i.y+(t?i.height/2-o.height/e/2:0),width:o.width/e,height:o.height/e}),this.viewbox(n),this.viewbox(!1).scale},Ht.prototype._setZoom=function(t,e){var n,r,o,i,a=this._svg,c=this._viewport,s=a.createSVGMatrix(),u=a.createSVGPoint(),l=(r=c.getCTM()).a;return e?(n=wt(u,e).matrixTransform(r.inverse()),o=s.translate(n.x,n.y).scale(1/l*t).translate(-n.x,-n.y),i=r.multiply(o)):i=s.scale(t),Gt(this._viewport,i),i},Ht.prototype.getSize=function(){return{width:this._container.clientWidth,height:this._container.clientHeight}},Ht.prototype.getAbsoluteBBox=function(t){var e,n=this.viewbox();t.waypoints?e=this.getGraphics(t).getBBox():e=t;return{x:e.x*n.scale-n.x*n.scale,y:e.y*n.scale-n.y*n.scale,width:e.width*n.scale,height:e.height*n.scale}},Ht.prototype.resized=function(){delete this._cachedViewbox,this._eventBus.fire("canvas.resized")};var It="data-element-id";function Vt(t){this._elements={},this._eventBus=t}Vt.$inject=["eventBus"],Vt.prototype.add=function(t,e,n){var r=t.id;this._validateId(r),S(e,It,r),n&&S(n,It,r),this._elements[r]={element:t,gfx:e,secondaryGfx:n}},Vt.prototype.remove=function(t){var e=this._elements,n=t.id||t,r=n&&e[n];r&&(S(r.gfx,It,""),r.secondaryGfx&&S(r.secondaryGfx,It,""),delete e[n])},Vt.prototype.updateId=function(t,e){this._validateId(e),"string"==typeof t&&(t=this.get(t)),this._eventBus.fire("element.updateId",{element:t,newId:e});var n=this.getGraphics(t),r=this.getGraphics(t,!0);this.remove(t),t.id=e,this.add(t,n,r)},Vt.prototype.get=function(t){var e;e="string"==typeof t?t:t&&S(t,It);var n=this._elements[e];return n&&n.element},Vt.prototype.filter=function(t){var e=[];return this.forEach(function(n,r){t(n,r)&&e.push(n)}),e},Vt.prototype.getAll=function(){return this.filter(function(t){return t})},Vt.prototype.forEach=function(t){var e=this._elements;Object.keys(e).forEach(function(n){var r=e[n],o=r.element,i=r.gfx;return t(o,i)})},Vt.prototype.getGraphics=function(t,e){var n=t.id||t,r=this._elements[n];return r&&(e?r.secondaryGfx:r.gfx)},Vt.prototype._validateId=function(t){if(!t)throw new Error("element must have an id");if(this._elements[t])throw new Error("element with id "+t+" already added")};var qt=n(1),Wt=n.n(qt),Ut=new Wt.a({name:"children",enumerable:!0,collection:!0},{name:"parent"}),Yt=new Wt.a({name:"labels",enumerable:!0,collection:!0},{name:"labelTarget"}),Kt=new Wt.a({name:"attachers",collection:!0},{name:"host"}),Xt=new Wt.a({name:"outgoing",collection:!0},{name:"source"}),Zt=new Wt.a({name:"incoming",collection:!0},{name:"target"});function Qt(){Object.defineProperty(this,"businessObject",{writable:!0}),Object.defineProperty(this,"label",{get:function(){return this.labels[0]},set:function(t){var e=this.label,n=this.labels;!t&&e?n.remove(e):n.add(t,0)}}),Ut.bind(this,"parent"),Yt.bind(this,"labels"),Xt.bind(this,"outgoing"),Zt.bind(this,"incoming")}function Jt(){Qt.call(this),Ut.bind(this,"children"),Kt.bind(this,"host"),Kt.bind(this,"attachers")}function te(){Jt.call(this)}function ee(){Jt.call(this),Yt.bind(this,"labelTarget")}function ne(){Qt.call(this),Xt.bind(this,"source"),Zt.bind(this,"target")}v()(Jt,Qt),v()(te,Jt),v()(ee,Jt),v()(ne,Qt);var re={connection:ne,shape:Jt,label:ee,root:te};function oe(){this._uid=12}oe.prototype.createRoot=function(t){return this.create("root",t)},oe.prototype.createLabel=function(t){return this.create("label",t)},oe.prototype.createShape=function(t){return this.create("shape",t)},oe.prototype.createConnection=function(t){return this.create("connection",t)},oe.prototype.create=function(t,e){return(e=wt({},e||{})).id||(e.id=t+"_"+this._uid++),function(t,e){var n=re[t];if(!n)throw new Error("unknown type: <"+t+">");return wt(new n,e)}(t,e)};var ie=Array.prototype.slice;function ae(){this._listeners={},this.on("diagram.destroy",1,this._destroy,this)}function ce(){}function se(t){return t.childNodes[0]}function ue(t,e,n){var r=F();r.setTranslate(e,n),G(t,r)}function le(t,e,n){return 2==arguments.length?t.getAttribute(e):null===n?t.removeAttribute(e):(t.setAttribute(e,n),t)}ae.prototype.on=function(t,e,n,r){if(t=Z(t)?t:[t],tt(e)&&(r=n,n=e,e=1e3),!J(e))throw new Error("priority must be a number");var o=n;r&&((o=xt(n,r)).__fn=n.__fn||n);var i=this;t.forEach(function(t){i._addListener(t,{priority:e,callback:o,next:null})})},ae.prototype.once=function(t,e,n,r){var o=this;if(tt(e)&&(r=n,n=e,e=1e3),!J(e))throw new Error("priority must be a number");function i(){var e=n.apply(r,arguments);return o.off(t,i),e}i.__fn=n,this.on(t,e,i)},ae.prototype.off=function(t,e){t=Z(t)?t:[t];var n=this;t.forEach(function(t){n._removeListener(t,e)})},ae.prototype.createEvent=function(t){var e=new ce;return e.init(t),e},ae.prototype.fire=function(t,e){var n,r,o,i;if(i=ie.call(arguments),"object"==typeof t&&(t=(n=t).type),!t)throw new Error("no event type specified");if(r=this._listeners[t]){n=e instanceof ce?e:this.createEvent(e),i[0]=n;var a=n.type;t!==a&&(n.type=t);try{o=this._invokeListeners(n,i,r)}finally{t!==a&&(n.type=a)}return void 0===o&&n.defaultPrevented&&(o=!1),o}},ae.prototype.handleError=function(t){return!1===this.fire("error",{error:t})},ae.prototype._destroy=function(){this._listeners={}},ae.prototype._invokeListeners=function(t,e,n){for(var r;n&&!t.cancelBubble;)r=this._invokeListener(t,e,n),n=n.next;return r},ae.prototype._invokeListener=function(t,e,n){var r;try{void 0!==(r=function(t,e){return t.apply(null,e)}(n.callback,e))&&(t.returnValue=r,t.stopPropagation()),!1===r&&t.preventDefault()}catch(t){if(!this.handleError(t))throw console.error("unhandled error in event listener"),console.error(t.stack),t}return r},ae.prototype._addListener=function(t,e){var n,r=this._getListeners(t);if(r){for(;r;){if(r.priority<e.priority)return e.next=r,void(n?n.next=e:this._setListeners(t,e));n=r,r=r.next}n.next=e}else this._setListeners(t,e)},ae.prototype._getListeners=function(t){return this._listeners[t]},ae.prototype._setListeners=function(t,e){this._listeners[t]=e},ae.prototype._removeListener=function(t,e){var n,r,o,i=this._getListeners(t);if(e)for(;i;)n=i.next,(o=i.callback)!==e&&o.__fn!==e||(r?r.next=n:this._setListeners(t,n)),r=i,i=n;else this._setListeners(t,null)},ce.prototype.stopPropagation=function(){this.cancelBubble=!0},ce.prototype.preventDefault=function(){this.defaultPrevented=!0},ce.prototype.init=function(t){wt(this,t||{})};var he=[].indexOf,pe=function(t,e){if(he)return t.indexOf(e);for(var n=0;n<t.length;++n)if(t[n]===e)return n;return-1},de=/\s+/,fe=Object.prototype.toString;function ve(t){return new ye(t)}function ye(t){if(!t||!t.nodeType)throw new Error("A DOM element reference is required");this.el=t,this.list=t.classList}function ge(t){for(var e;t.childNodes.length;)e=t.childNodes[0],t.removeChild(e);return t}ye.prototype.add=function(t){if(this.list)return this.list.add(t),this;var e=this.array();return~pe(e,t)||e.push(t),this.el.className=e.join(" "),this},ye.prototype.remove=function(t){if("[object RegExp]"==fe.call(t))return this.removeMatching(t);if(this.list)return this.list.remove(t),this;var e=this.array(),n=pe(e,t);return~n&&e.splice(n,1),this.el.className=e.join(" "),this},ye.prototype.removeMatching=function(t){for(var e=this.array(),n=0;n<e.length;n++)t.test(e[n])&&this.remove(e[n]);return this},ye.prototype.toggle=function(t,e){return this.list?(void 0!==e?e!==this.list.toggle(t,e)&&this.list.toggle(t):this.list.toggle(t),this):(void 0!==e?e?this.add(t):this.remove(t):this.has(t)?this.remove(t):this.add(t),this)},ye.prototype.array=function(){var t=(this.el.getAttribute("class")||"").replace(/^\s+|\s+$/g,"").split(de);return""===t[0]&&t.shift(),t},ye.prototype.has=ye.prototype.contains=function(t){return this.list?this.list.contains(t):!!~pe(this.array(),t)};var me=Element.prototype,xe=me.matchesSelector||me.webkitMatchesSelector||me.mozMatchesSelector||me.msMatchesSelector||me.oMatchesSelector,_e=function(t,e){if(xe)return xe.call(t,e);for(var n=t.parentNode.querySelectorAll(e),r=0;r<n.length;++r)if(n[r]==t)return!0;return!1};var we,be=function(t,e,n){for(var r=n?t:t.parentNode;r&&r!==document;){if(_e(r,e))return r;r=r.parentNode}},Ee=window.addEventListener?"addEventListener":"attachEvent",Se=window.removeEventListener?"removeEventListener":"detachEvent",Ce="addEventListener"!==Ee?"on":"",ke={bind:function(t,e,n,r){return t[Ee](Ce+e,n,r||!1),n},unbind:function(t,e,n,r){return t[Se](Ce+e,n,r||!1),n}},je=["focus","blur"],Me={bind:function(t,e,n,r,o){return-1!==je.indexOf(n)&&(o=!0),ke.bind(t,n,function(n){var o=n.target||n.srcElement;n.delegateTarget=be(o,e,!0,t),n.delegateTarget&&r.call(t,n)},o)},unbind:function(t,e,n,r){-1!==je.indexOf(e)&&(r=!0),ke.unbind(t,e,n,r)}},Oe=function(t,e){if("string"!=typeof t)throw new TypeError("String expected");e||(e=document);var n=/<([\w:]+)/.exec(t);if(!n)return e.createTextNode(t);t=t.replace(/^\s+|\s+$/g,"");var r=n[1];if("body"==r){var o=e.createElement("html");return o.innerHTML=t,o.removeChild(o.lastChild)}var i=Be[r]||Be._default,a=i[0],c=i[1],s=i[2];(o=e.createElement("div")).innerHTML=c+t+s;for(;a--;)o=o.lastChild;if(o.firstChild==o.lastChild)return o.removeChild(o.firstChild);var u=e.createDocumentFragment();for(;o.firstChild;)u.appendChild(o.removeChild(o.firstChild));return u},Pe=!1;"undefined"!=typeof document&&((we=document.createElement("div")).innerHTML='  <link/><table></table><a href="/a">a</a><input type="checkbox"/>',Pe=!we.getElementsByTagName("link").length,we=void 0);var Be={legend:[1,"<fieldset>","</fieldset>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],_default:Pe?[1,"X<div>","</div>"]:[0,"",""]};Be.td=Be.th=[3,"<table><tbody><tr>","</tr></tbody></table>"],Be.option=Be.optgroup=[1,'<select multiple="multiple">',"</select>"],Be.thead=Be.tbody=Be.colgroup=Be.caption=Be.tfoot=[1,"<table>","</table>"],Be.polyline=Be.ellipse=Be.polygon=Be.circle=Be.text=Be.line=Be.path=Be.rect=Be.g=[1,'<svg xmlns="http://www.w3.org/2000/svg" version="1.1">',"</svg>"];var Re="undefined"!=typeof Element?Element.prototype:{},Ae=Re.matches||Re.matchesSelector||Re.webkitMatchesSelector||Re.mozMatchesSelector||Re.msMatchesSelector||Re.oMatchesSelector,ze=function(t,e){if(!t||1!==t.nodeType)return!1;if(Ae)return Ae.call(t,e);for(var n=t.parentNode.querySelectorAll(e),r=0;r<n.length;r++)if(n[r]==t)return!0;return!1};function Te(t,e){return(e=e||document).querySelector(t)}function $e(t){t.parentNode&&t.parentNode.removeChild(t)}function Le(t,e){this._eventBus=t,this._elementRegistry=e}function De(t,e,n){var r=n||e.firstChild;t!==r&&e.insertBefore(t,r)}Le.$inject=["eventBus","elementRegistry"],Le.prototype._getChildren=function(t){var e,n=this._elementRegistry.getGraphics(t);return t.parent?(e=function(t){return t.parentNode.childNodes[1]}(n))||(O(e=L("g")).add("djs-children"),_(n.parentNode,e)):e=n,e},Le.prototype._clear=function(t){var e=se(t);return ge(e),e},Le.prototype._createContainer=function(t,e,n,r){var o=L("g");O(o).add("djs-group"),void 0!==n?De(o,e,e.childNodes[n]):_(e,o);var i=L("g");O(i).add("djs-element"),O(i).add("djs-"+t),r&&O(i).add("djs-frame"),_(o,i);var a=L("g");return O(a).add("djs-visual"),_(i,a),i},Le.prototype.create=function(t,e,n){var r=this._getChildren(e.parent);return this._createContainer(t,r,n,Ot(e))},Le.prototype.updateContainments=function(t){var e=this,n=this._elementRegistry;it(at(t,function(t,e){return e.parent&&(t[e.parent.id]=e.parent),t},{}),function(t){var r=t.children;if(r){var o=e._getChildren(t);it(r.slice().reverse(),function(t){De(n.getGraphics(t).parentNode,o)})}})},Le.prototype.drawShape=function(t,e){return this._eventBus.fire("render.shape",{gfx:t,element:e})},Le.prototype.getShapePath=function(t){return this._eventBus.fire("render.getShapePath",t)},Le.prototype.drawConnection=function(t,e){return this._eventBus.fire("render.connection",{gfx:t,element:e})},Le.prototype.getConnectionPath=function(t){return this._eventBus.fire("render.getConnectionPath",t)},Le.prototype.update=function(t,e,n){if(e.parent){var r=this._clear(n);if("shape"===t)this.drawShape(r,e),ue(n,e.x,e.y);else{if("connection"!==t)throw new Error("unknown type: "+t);this.drawConnection(r,e)}e.hidden?S(n,"display","none"):S(n,"display","block")}},Le.prototype.remove=function(t){B(this._elementRegistry.getGraphics(t).parentNode)};var Ne={__depends__:[At],__init__:["canvas"],canvas:["type",Ht],elementRegistry:["type",Vt],elementFactory:["type",oe],eventBus:["type",ae],graphicsFactory:["type",Le]};function Fe(t){var e=[],n=[];function r(t){return e.indexOf(t)>=0}t.forEach(function t(o){r(o)||((o.__depends__||[]).forEach(t),r(o)||(function(t){e.push(t)}(o),(o.__init__||[]).forEach(function(t){n.push(t)})))});var o=new p(e);return n.forEach(function(t){try{o["string"==typeof t?"get":"invoke"](t)}catch(t){throw console.error("Failed to instantiate component"),console.error(t.stack),t}}),o}function He(t,e){this.injector=e=e||function(t){return Fe([{config:["value",t=t||{}]},Ne].concat(t.modules||[]))}(t),this.get=e.get,this.invoke=e.invoke,this.get("eventBus").fire("diagram.init")}function Ge(t){t&&"function"==typeof t.stopPropagation&&t.stopPropagation()}function Ie(t){return t.originalEvent||t.srcEvent}function Ve(t,e){Ge(t),Ge(Ie(t))}function qe(t){return t.pointers&&t.pointers.length&&(t=t.pointers[0]),t.touches&&t.touches.length&&(t=t.touches[0]),t?{x:t.clientX,y:t.clientY}:null}function We(t){return!(Ie(t)||t).button}function Ue(t){var e=Ie(t)||t;return!!We(t)&&(/mac/i.test(navigator.platform)?e.metaKey:e.ctrlKey)}function Ye(t){return!0}He.prototype.destroy=function(){this.get("eventBus").fire("diagram.destroy")},He.prototype.clear=function(){this.get("eventBus").fire("diagram.clear")};var Ke=500;function Xe(t,e,n){var r=this;function o(n,r,o){var i,a;(function(t,e){return!(s[t]||We)(e)})(n,r)||(o?a=e.getGraphics(o):(i=r.delegateTarget||r.target)&&(a=i,o=e.get(a)),a&&o&&!1===t.fire(n,{element:o,gfx:a,originalEvent:r})&&(r.stopPropagation(),r.preventDefault()))}var i={};function a(t){return i[t]}var c={click:"element.click",contextmenu:"element.contextmenu",dblclick:"element.dblclick",mousedown:"element.mousedown",mousemove:"element.mousemove",mouseover:"element.hover",mouseout:"element.out",mouseup:"element.mouseup"},s={"element.contextmenu":Ye};var u="svg, .djs-element";function l(t,e,n,r){var a=i[n]=function(t){o(n,t)};r&&(s[n]=r),a.$delegate=Me.bind(t,u,e,a)}function h(t,e,n){var r=a(n);r&&Me.unbind(t,e,r.$delegate)}t.on("canvas.destroy",function(t){var e;e=t.svg,it(c,function(t,n){h(e,n,t)})}),t.on("canvas.init",function(t){var e;e=t.svg,it(c,function(t,n){l(e,n,t)})}),t.on(["shape.added","connection.added"],function(e){var n=e.element,r=e.gfx;t.fire("interactionEvents.createHit",{element:n,gfx:r})}),t.on(["shape.changed","connection.changed"],Ke,function(e){var n=e.element,r=e.gfx;t.fire("interactionEvents.updateHit",{element:n,gfx:r})}),t.on("interactionEvents.createHit",Ke,function(t){var e=t.element,n=t.gfx;r.createDefaultHit(e,n)}),t.on("interactionEvents.updateHit",function(t){var e=t.element,n=t.gfx;r.updateDefaultHit(e,n)});var p=v("djs-hit djs-hit-stroke"),d=v("djs-hit djs-hit-click-stroke"),f={all:v("djs-hit djs-hit-all"),"click-stroke":d,stroke:p};function v(t,e){return e=wt({stroke:"white",strokeWidth:15},e||{}),n.cls(t,["no-fill","no-border"],e)}function y(t,e){var n=f[e];if(!n)throw new Error("invalid hit type <"+e+">");return S(t,n),t}function g(t,e){_(t,e)}this.removeHits=function(t){var e;it((e=".djs-hit",(t||document).querySelectorAll(e)),B)},this.createDefaultHit=function(t,e){var n,r=t.waypoints,o=t.isFrame;return r?this.createWaypointsHit(e,r):(n=o?"stroke":"all",this.createBoxHit(e,n,{width:t.width,height:t.height}))},this.createWaypointsHit=function(t,e){var n=q(e);return y(n,"stroke"),g(t,n),n},this.createBoxHit=function(t,e,n){n=wt({x:0,y:0},n);var r=L("rect");return y(r,e),S(r,n),g(t,r),r},this.updateDefaultHit=function(t,e){var n=Te(".djs-hit",e);if(n)return t.waypoints?function(t,e){S(t,{points:V(e)})}(n,t.waypoints):S(n,{width:t.width,height:t.height}),n},this.fire=o,this.triggerMouseEvent=function(t,e,n){var r=c[t];if(!r)throw new Error("unmapped DOM event name <"+t+">");return o(r,e,n)},this.mouseHandler=a,this.registerEvent=l,this.unregisterEvent=h}Xe.$inject=["eventBus","elementRegistry","styles"];var Ze={__init__:["interactionEvents"],interactionEvents:["type",Xe]},Qe=500;function Je(t,e,n){this.offset=6;var r=e.cls("djs-outline",["no-fill"]),o=this;function i(t,e){var n=L("rect");return S(n,wt({x:10,y:10,width:100,height:100},r)),_(t,n),n}t.on(["shape.added","shape.changed"],Qe,function(t){var e=t.element,n=t.gfx,r=Te(".djs-outline",n);r||(r=i(n)),o.updateShapeOutline(r,e)}),t.on(["connection.added","connection.changed"],function(t){var e=t.element,n=t.gfx,r=Te(".djs-outline",n);r||(r=i(n)),o.updateConnectionOutline(r,e)})}Je.prototype.updateShapeOutline=function(t,e){S(t,{x:-this.offset,y:-this.offset,width:e.width+2*this.offset,height:e.height+2*this.offset})},Je.prototype.updateConnectionOutline=function(t,e){var n=jt(e);S(t,{x:n.x-this.offset,y:n.y-this.offset,width:n.width+2*this.offset,height:n.height+2*this.offset})},Je.$inject=["eventBus","styles","elementRegistry"];var tn={__init__:["outline"],outline:["type",Je]};function en(t){this._eventBus=t,this._selectedElements=[];var e=this;t.on(["shape.remove","connection.remove"],function(t){var n=t.element;e.deselect(n)}),t.on(["diagram.clear"],function(t){e.select(null)})}en.$inject=["eventBus"],en.prototype.deselect=function(t){var e=this._selectedElements,n=e.indexOf(t);if(-1!==n){var r=e.slice();e.splice(n,1),this._eventBus.fire("selection.changed",{oldSelection:r,newSelection:e})}},en.prototype.get=function(){return this._selectedElements},en.prototype.isSelected=function(t){return-1!==this._selectedElements.indexOf(t)},en.prototype.select=function(t,e){var n=this._selectedElements,r=n.slice();Z(t)||(t=t?[t]:[]),e?it(t,function(t){-1===n.indexOf(t)&&n.push(t)}):this._selectedElements=n=t.slice(),this._eventBus.fire("selection.changed",{oldSelection:r,newSelection:n})};var nn="hover",rn="selected";function on(t,e,n,r){function o(t,n){e.addMarker(t,n)}function i(t,n){e.removeMarker(t,n)}this._multiSelectionBox=null,t.on("element.hover",function(t){o(t.element,nn)}),t.on("element.out",function(t){i(t.element,nn)}),t.on("selection.changed",function(t){var e=t.oldSelection,n=t.newSelection;it(e,function(t){-1===n.indexOf(t)&&i(t,rn)}),it(n,function(t){-1===e.indexOf(t)&&o(t,rn)})})}function an(t,e,n,r){t.on("create.end",500,function(t){var n=t.context,r=n.canExecute,o=n.elements,i=(n.hints||{}).autoSelect;if(r){if(!1===i)return;Z(i)?e.select(i):e.select(o)}}),t.on("connect.end",500,function(t){t.context.canExecute&&t.context.target&&e.select(t.context.target)}),t.on("shape.move.end",500,function(t){var n=t.previousSelection||[],o=r.get(t.context.shape.id);rt(n,function(t){return o.id===t.id})||e.select(o)}),t.on("element.click",function(t){var r=t.element;r===n.getRootElement()&&(r=null);var o=e.isSelected(r),i=e.get().length>1,a=Ue(t);if(o&&i)return a?e.deselect(r):e.select(r);o?e.deselect(r):e.select(r,a)})}on.$inject=["eventBus","canvas","selection","styles"],an.$inject=["eventBus","selection","canvas","elementRegistry"];var cn={__init__:["selectionVisuals","selectionBehavior"],__depends__:[Ze,tn],selection:["type",en],selectionVisuals:["type",on],selectionBehavior:["type",an]};function sn(t){this._commandStack=t.get("commandStack",!1)}sn.$inject=["injector"],sn.prototype.allowed=function(t,e){var n=!0,r=this._commandStack;return r&&(n=r.canExecute(t,e)),void 0===n||n};var un={__init__:["rules"],rules:["type",sn]},ln=/^djs-cursor-.*$/;function hn(t){var e=ve(document.body);e.removeMatching(ln),t&&e.add("djs-cursor-"+t)}function pn(){hn(null)}var dn=5e3;function fn(t,e){function n(){return!1}return e=e||"element.click",t.once(e,dn,n),function(){t.off(e,n)}}function vn(t){return{x:t.x+t.width/2,y:t.y+t.height/2}}function yn(t,e){return{x:t.x-e.x,y:t.y-e.y}}var gn=Math.round,mn="djs-drag-active";function xn(t){t.preventDefault()}function _n(t,e,n){var r,o={threshold:5,trapClick:!0};function i(t){var n=e.viewbox(),r=e._container.getBoundingClientRect();return{x:n.x+(t.x-r.left)/n.scale,y:n.y+(t.y-r.top)/n.scale}}function a(e,n){n=n||r;var o=t.createEvent(wt({},n.payload,n.data,{isTouch:n.isTouch}));return!1!==t.fire("drag."+e,o)&&t.fire(n.prefix+"."+e,o)}function c(t,o){var c,s=r.payload,u=r.displacement,l=r.globalStart,h=qe(t),p=yn(h,l),d=r.localStart,v=i(h),y=yn(v,d);if(!r.active&&(o||(c=p,Math.sqrt(Math.pow(c.x,2)+Math.pow(c.y,2))>r.threshold))){if(wt(s,{x:gn(d.x+u.x),y:gn(d.y+u.y),dx:0,dy:0},{originalEvent:t}),!1===a("start"))return f();r.active=!0,r.keepSelection||(s.previousSelection=n.get(),n.select(null)),r.cursor&&hn(r.cursor),e.addMarker(e.getRootElement(),mn)}Ve(t),r.active&&(wt(s,{x:gn(v.x+u.x),y:gn(v.y+u.y),dx:gn(y.x),dy:gn(y.y)},{originalEvent:t}),a("move"))}function s(t){var e=!0;r.active&&(t&&(r.payload.originalEvent=t,Ve(t)),e=a("end")),!1===e&&a("rejected"),a("ended",v(!0!==e))}function u(t){27===t.which&&(xn(t),f())}function l(e){var n;r.active&&(n=fn(t),setTimeout(n,400),xn(e)),s(e)}function h(t){c(t)}function p(t){var e=r.payload;e.hoverGfx=t.gfx,e.hover=t.element,a("hover")}function d(t){a("out");var e=r.payload;e.hoverGfx=null,e.hover=null}function f(t){var e;if(r){var n=r.active;n&&a("cancel"),e=v(t),n&&a("canceled",e)}}function v(o){var i,v;a("cleanup"),pn(),v=r.trapClick?l:s,ke.unbind(document,"mousemove",c),ke.unbind(document,"dragstart",xn),ke.unbind(document,"selectstart",xn),ke.unbind(document,"mousedown",v,!0),ke.unbind(document,"mouseup",v,!0),ke.unbind(document,"keyup",u),ke.unbind(document,"touchstart",h,!0),ke.unbind(document,"touchcancel",f,!0),ke.unbind(document,"touchmove",c,!0),ke.unbind(document,"touchend",s,!0),t.off("element.hover",p),t.off("element.out",d),e.removeMarker(e.getRootElement(),mn);var y=r.payload.previousSelection;return!1!==o&&y&&!n.get().length&&n.select(y),i=r,r=null,i}t.on("diagram.destroy",f),this.init=function(e,n,v,y){r&&f(!1),"string"==typeof n&&(y=v,v=n,n=null);var g,m,x,_,w,b=(y=wt({},o,y||{})).data||{};_=y.trapClick?l:s,e?(g=Ie(e)||e,m=qe(e),Ve(e),"dragstart"===g.type&&xn(g)):(g=null,m={x:0,y:0}),x=i(m),n||(n=x),w=function(t){return"undefined"!=typeof TouchEvent&&t instanceof TouchEvent}(g),r=wt({prefix:v,data:b,payload:{},globalStart:m,displacement:yn(n,x),localStart:x,isTouch:w},y),y.manual||(w?(ke.bind(document,"touchstart",h,!0),ke.bind(document,"touchcancel",f,!0),ke.bind(document,"touchmove",c,!0),ke.bind(document,"touchend",s,!0)):(ke.bind(document,"mousemove",c),ke.bind(document,"dragstart",xn),ke.bind(document,"selectstart",xn),ke.bind(document,"mousedown",_,!0),ke.bind(document,"mouseup",_,!0)),ke.bind(document,"keyup",u),t.on("element.hover",p),t.on("element.out",d)),a("init"),y.autoActivate&&c(e,!0)},this.move=c,this.hover=p,this.out=d,this.end=s,this.cancel=f,this.context=function(){return r},this.setOptions=function(t){wt(o,t)}}_n.$inject=["eventBus","canvas","selection"];var wn=1500;function bn(t,e,n){var r=this;t.on("drag.start",function(o){t.once("drag.move",wn,function(t){!function(t){if(!t.hover){var o=t.originalEvent,i=r._findTargetGfx(o),a=i&&n.get(i);i&&a&&(t.stopPropagation(),e.hover({element:a,gfx:i}),e.move(o))}}(t)})}),t.on("drag.init",function(){var n,r;function o(t){n=t.hover,r=t.hoverGfx}function i(){n=null,r=null}function a(){if(n){var t=n,o=r;n=null,r=null,e.out({element:t,gfx:o})}}t.on("drag.hover",o),t.on("element.out",i),t.on("element.hover",wn,a),t.once("drag.cleanup",function(){t.off("drag.hover",o),t.off("element.out",i),t.off("element.hover",a)})}),this._findTargetGfx=function(t){var e;if(t instanceof MouseEvent)return e=qe(t),function(t){return be(t,"svg, .djs-element",!0)}(document.elementFromPoint(e.x,e.y))}}bn.$inject=["eventBus","dragging","elementRegistry"];var En={__init__:["hoverFix"],__depends__:[cn],dragging:["type",_n],hoverFix:["type",bn]};n(4);function Sn(t){return{x:Math.round(t.x),y:Math.round(t.y)}}function Cn(t){return{top:t.y,right:t.x+(t.width||0),bottom:t.y+(t.height||0),left:t.x}}function kn(t){return{x:t.left,y:t.top,width:t.right-t.left,height:t.bottom-t.top}}function jn(t){return Sn({x:t.x+(t.width||0)/2,y:t.y+(t.height||0)/2})}function Mn(t,e,n,r){function o(t,e){return r.allowed("connection.create",{source:t,target:e})}t.on("connect.hover",function(t){var e=t.context,n=e.source,r=t.hover;null!==(e.canExecute=o(n,r))&&(e.target=r)}),t.on(["connect.out","connect.cleanup"],function(t){var e=t.context;e.target=null,e.canExecute=!1}),t.on("connect.end",function(t){var e=t.context,r=e.source,i=e.sourcePosition,a=e.target,c={x:t.x,y:t.y},s=e.canExecute||o(r,a);if(!s)return!1;var u=null,l={connectionStart:i,connectionEnd:c};"object"==typeof s&&(u=s),n.connect(r,a,u,l)}),this.start=function(t,n,r,o){"object"!=typeof r&&(o=r,r=jn(n)),e.init(t,"connect",{autoActivate:o,data:{shape:n,context:{source:n,sourcePosition:r}}})}}Mn.$inject=["eventBus","dragging","modeling","rules"];var On=1100,Pn=900,Bn="connect-ok",Rn="connect-not-ok";function An(t,e,n){var r=t.get("connectionPreview",!1);r&&e.on("connect.move",function(t){var e=t.context,n=e.source,o=e.target,i=e.canExecute,a={x:t.x,y:t.y};r.drawPreview(e,i,{source:n,target:o,connectionEnd:a})}),e.on("connect.hover",Pn,function(t){var e=t.context,r=t.hover,o=e.canExecute;null!==o&&n.addMarker(r,o?Bn:Rn)}),e.on(["connect.out","connect.cleanup"],On,function(t){var e=t.context;e.target&&n.removeMarker(e.target,e.canExecute?Bn:Rn)}),r&&e.on("connect.cleanup",function(t){r.cleanUp(t.context)})}An.$inject=["injector","eventBus","canvas"];var zn={__depends__:[cn,un,En],__init__:["connectPreview"],connect:["type",Mn],connectPreview:["type",An]};function Tn(t){this._counter=0,this._prefix=(t?t+"-":"")+Math.floor(1e9*Math.random())+"-"}Tn.prototype.next=function(){return this._prefix+ ++this._counter};var $n=new Tn("ov");function Ln(t,e,n,r){var o,i;this._eventBus=e,this._canvas=n,this._elementRegistry=r,this._ids=$n,this._overlayDefaults=wt({show:null,scale:!0},t&&t.defaults),this._overlays={},this._overlayContainers=[],this._overlayRoot=(o=n.getContainer(),i=Oe('<div class="djs-overlay-container" style="position: absolute; width: 0; height: 0;" />'),o.insertBefore(i,o.firstChild),i),this._init()}function Dn(t,e,n){wt(t.style,{left:e+"px",top:n+"px"})}function Nn(t,e){t.style.display=!1===e?"none":""}function Fn(t,e){t.style["transform-origin"]="top left",["","-ms-","-webkit-"].forEach(function(n){t.style[n+"transform"]=e})}Ln.$inject=["config.overlays","eventBus","canvas","elementRegistry"],Ln.prototype.get=function(t){if(et(t)&&(t={id:t}),et(t.element)&&(t.element=this._elementRegistry.get(t.element)),t.element){var e=this._getOverlayContainer(t.element,!0);return e?t.type?ot(e.overlays,ft({type:t.type})):e.overlays.slice():[]}return t.type?ot(this._overlays,ft({type:t.type})):t.id?this._overlays[t.id]:null},Ln.prototype.add=function(t,e,n){if(Q(e)&&(n=e,e=null),t.id||(t=this._elementRegistry.get(t)),!n.position)throw new Error("must specifiy overlay position");if(!n.html)throw new Error("must specifiy overlay html");if(!t)throw new Error("invalid element specified");var r=this._ids.next();return n=wt({},this._overlayDefaults,n,{id:r,type:e,element:t,html:n.html}),this._addOverlay(n),r},Ln.prototype.remove=function(t){var e=this.get(t)||[];Z(e)||(e=[e]);var n=this;it(e,function(t){var e=n._getOverlayContainer(t.element,!0);if(t&&($e(t.html),$e(t.htmlContainer),delete t.htmlContainer,delete t.element,delete n._overlays[t.id]),e){var r=e.overlays.indexOf(t);-1!==r&&e.overlays.splice(r,1)}})},Ln.prototype.show=function(){Nn(this._overlayRoot)},Ln.prototype.hide=function(){Nn(this._overlayRoot,!1)},Ln.prototype.clear=function(){this._overlays={},this._overlayContainers=[],ge(this._overlayRoot)},Ln.prototype._updateOverlayContainer=function(t){var e=t.element,n=t.html,r=e.x,o=e.y;if(e.waypoints){var i=jt(e);r=i.x,o=i.y}Dn(n,r,o),le(t.html,"data-container-id",e.id)},Ln.prototype._updateOverlay=function(t){var e,n,r=t.position,o=t.htmlContainer,i=t.element,a=r.left,c=r.top;void 0!==r.right&&(e=i.waypoints?jt(i).width:i.width,a=-1*r.right+e);void 0!==r.bottom&&(n=i.waypoints?jt(i).height:i.height,c=-1*r.bottom+n);Dn(o,a||0,c||0)},Ln.prototype._createOverlayContainer=function(t){var e=Oe('<div class="djs-overlays" style="position: absolute" />');this._overlayRoot.appendChild(e);var n={html:e,element:t,overlays:[]};return this._updateOverlayContainer(n),this._overlayContainers.push(n),n},Ln.prototype._updateRoot=function(t){var e=t.scale||1,n="matrix("+[e,0,0,e,-1*t.x*e,-1*t.y*e].join(",")+")";Fn(this._overlayRoot,n)},Ln.prototype._getOverlayContainer=function(t,e){var n=rt(this._overlayContainers,function(e){return e.element===t});return n||e?n:this._createOverlayContainer(t)},Ln.prototype._addOverlay=function(t){var e,n,r=t.id,o=t.element,i=t.html;i.get&&i.constructor.prototype.jquery&&(i=i.get(0)),et(i)&&(i=Oe(i)),n=this._getOverlayContainer(o),(e=Oe('<div class="djs-overlay" data-overlay-id="'+r+'" style="position: absolute">')).appendChild(i),t.type&&ve(e).add("djs-overlay-"+t.type),t.htmlContainer=e,n.overlays.push(t),n.html.appendChild(e),this._overlays[r]=t,this._updateOverlay(t),this._updateOverlayVisibilty(t,this._canvas.viewbox())},Ln.prototype._updateOverlayVisibilty=function(t,e){var n=t.show,r=n&&n.minZoom,o=n&&n.maxZoom,i=t.htmlContainer,a=!0;n&&((X(r)&&r>e.scale||X(o)&&o<e.scale)&&(a=!1),Nn(i,a)),this._updateOverlayScale(t,e)},Ln.prototype._updateOverlayScale=function(t,e){var n,r,o,i=t.scale,a=t.htmlContainer,c="";!0!==i&&(!1===i?(n=1,r=1):(n=i.min,r=i.max),X(n)&&e.scale<n&&(o=(1/e.scale||1)*n),X(r)&&e.scale>r&&(o=(1/e.scale||1)*r)),X(o)&&(c="scale("+o+","+o+")"),Fn(a,c)},Ln.prototype._updateOverlaysVisibilty=function(t){var e=this;it(this._overlays,function(n){e._updateOverlayVisibilty(n,t)})},Ln.prototype._init=function(){var t=this._eventBus,e=this;t.on("canvas.viewbox.changing",function(t){e.hide()}),t.on("canvas.viewbox.changed",function(t){var n;n=t.viewbox,e._updateRoot(n),e._updateOverlaysVisibilty(n),e.show()}),t.on(["shape.remove","connection.remove"],function(t){var n=t.element;it(e.get({element:n}),function(t){e.remove(t.id)});var r=e._getOverlayContainer(n);if(r){$e(r.html);var o=e._overlayContainers.indexOf(r);-1!==o&&e._overlayContainers.splice(o,1)}}),t.on("element.changed",500,function(t){var n=t.element,r=e._getOverlayContainer(n,!0);r&&(it(r.overlays,function(t){e._updateOverlay(t)}),e._updateOverlayContainer(r))}),t.on("element.marker.update",function(t){var n=e._getOverlayContainer(t.element,!0);n&&ve(n.html)[t.add?"add":"remove"](t.marker)}),t.on("diagram.clear",this.clear,this)};var Hn={__init__:["overlays"],overlays:["type",Ln]};function Gn(t,e,n){this._providers=[],this._eventBus=e,this._overlays=n;var r=X(t&&t.scale)?t.scale:{min:1,max:1.5};this._overlaysConfig={position:{right:-9,top:-6},scale:r},this._current=null,this._init()}Gn.$inject=["config.contextPad","eventBus","overlays"],Gn.prototype._init=function(){var t=this._eventBus,e=this;t.on("selection.changed",function(t){var n=t.newSelection;1===n.length?e.open(n[0]):e.close()}),t.on("elements.delete",function(t){it(t.elements,function(t){e.isOpen(t)&&e.close()})}),t.on("element.changed",function(t){var n=t.element,r=e._current;r&&r.element===n&&e.open(n,!0)})},Gn.prototype.registerProvider=function(t){this._providers.push(t)},Gn.prototype.getEntries=function(t){var e={};return it(this._providers,function(n){it(n.getContextPadEntries(t),function(t,n){e[n]=t})}),e},Gn.prototype.trigger=function(t,e,n){var r,o,i=this._current.element,a=this._current.entries,c=e.delegateTarget||e.target;if(!c)return e.preventDefault();if(r=a[le(c,"data-action")].action,o=e.originalEvent||e,tt(r)){if("click"===t)return r(o,i,n)}else if(r[t])return r[t](o,i,n);e.preventDefault()},Gn.prototype.open=function(t,e){!e&&this.isOpen(t)||(this.close(),this._updateAndOpen(t))},Gn.prototype._updateAndOpen=function(t){var e=this.getEntries(t),n=this.getPad(t),r=n.html;it(e,function(t,e){var n,o,i,a,c=t.group||"default",s=Oe(t.html||'<div class="entry" draggable="true"></div>');le(s,"data-action",e),(n=Te("[data-group="+c+"]",r))||(n=Oe('<div class="group" data-group="'+c+'"></div>'),r.appendChild(n)),n.appendChild(s),t.className&&(o=s,i=t.className,a=ve(o),(Z(i)?i:i.split(/\s+/g)).forEach(function(t){a.add(t)})),t.title&&le(s,"title",t.title),t.imageUrl&&s.appendChild(Oe('<img src="'+t.imageUrl+'">'))}),ve(r).add("open"),this._current={element:t,pad:n,entries:e},this._eventBus.fire("contextPad.open",{current:this._current})},Gn.prototype.getPad=function(t){if(this.isOpen())return this._current.pad;var e=this,n=this._overlays,r=Oe('<div class="djs-context-pad"></div>'),o=wt({html:r},this._overlaysConfig);Me.bind(r,".entry","click",function(t){e.trigger("click",t)}),Me.bind(r,".entry","dragstart",function(t){e.trigger("dragstart",t)}),ke.bind(r,"mousedown",function(t){t.stopPropagation()}),this._overlayId=n.add(t,"context-pad",o);var i=n.get(this._overlayId);return this._eventBus.fire("contextPad.create",{element:t,pad:i}),i},Gn.prototype.close=function(){this.isOpen()&&(this._overlays.remove(this._overlayId),this._overlayId=null,this._eventBus.fire("contextPad.close",{current:this._current}),this._current=null)},Gn.prototype.isOpen=function(t){return!(!this._current||t&&this._current.element!==t)};var In={__depends__:[Ze,Hn],contextPad:["type",Gn]},Vn=["marker-start","marker-mid","marker-end"],qn=["circle","ellipse","line","path","polygon","polyline","rect"];function Wn(t,e,n,r){this._elementRegistry=t,this._canvas=n,this._styles=r,this._clonedMarkers={};var o=this;e.on("drag.cleanup",function(){it(o._clonedMarkers,function(t){B(t)}),o._clonedMarkers={}})}Wn.$inject=["elementRegistry","eventBus","canvas","styles"],Wn.prototype.getGfx=function(t){return this._elementRegistry.getGraphics(t)},Wn.prototype.addDragger=function(t,e,n){var r=A(n=n||this.getGfx(t)),o=n.getBoundingClientRect();return this._cloneMarkers(se(r)),S(r,this._styles.cls("djs-dragger",[],{x:o.top,y:o.left})),_(e,r),r},Wn.prototype.addFrame=function(t,e){var n=L("rect",{class:"djs-resize-overlay",width:t.width,height:t.height,x:t.x,y:t.y});return _(e,n),n},Wn.prototype._cloneMarkers=function(t){var e,n=this;if(t.childNodes)for(var r=0;r<t.childNodes.length;r++)n._cloneMarkers(t.childNodes[r]);(e=t,-1!==qn.indexOf(e.nodeName))&&Vn.forEach(function(e){if(S(t,e)){var r=function(t,e,n){return Te("marker#"+(r=S(t,e),r.match(/url\(['"]?#([^'"]*)['"]?\)/)[1]),n||document);var r}(t,e,n._canvas.getContainer());n._cloneMarker(t,r,e)}})},Wn.prototype._cloneMarker=function(t,e,n){var r=e.id,o=this._clonedMarkers[r];if(!o){var i=r+"-clone";(o=A(e)).id=i,O(o).add("djs-dragger").add("djs-dragger-marker"),this._clonedMarkers[r]=o;var a=Te("defs",this._canvas._svg);a||(a=L("defs"),_(this._canvas._svg,a)),_(a,o)}S(t,n,"url(#"+this._clonedMarkers[r].id+")")};var Un={__init__:["previewSupport"],previewSupport:["type",Wn]},Yn="drop-ok",Kn="drop-not-ok",Xn="attach-ok",Zn="new-parent";function Qn(t,e,n,r,o){function i(e,n){[Xn,Yn,Kn,Zn].forEach(function(r){r===n?t.addMarker(e,r):t.removeMarker(e,r)})}n.on(["create.move","create.hover"],function(t){var e=t.context,n=e.elements,r=t.hover,a=e.source;if(!r)return e.canExecute=!1,void(e.target=null);Jn(t);var c={x:t.x,y:t.y},s=e.canExecute=r&&function(t,e,n,r){if(!e)return!1;var i=rt(t=ot(t,function(t){return!t.parent}),function(t){return!tr(t)}),a=!1,c=!1,s=!1;return er(t)&&(a=o.allowed("shape.attach",{position:n,shape:i,target:e})),a||(s=er(t)?o.allowed("shape.create",{position:n,shape:i,source:r,target:e}):o.allowed("elements.create",{elements:t,position:n,target:e})),s||a?(i&&r&&(c=o.allowed("connection.create",{source:r,target:i,hints:{targetParent:e,targetAttach:a}})),{attach:a,connect:c}):(null===s||null===a)&&null}(n,r,c,a);r&&null!==s&&(e.target=r,s&&s.attach?i(r,Xn):i(r,s?Zn:Kn))}),n.on(["create.end","create.out","create.cleanup"],function(t){var e=t.hover;e&&i(e,null)}),n.on("create.end",function(t){var e=t.context,n=e.source,o=e.shape,i=e.elements,a=e.target,c=e.hints,s=e.canExecute,u=s&&s.attach,l=s&&s.connect;if(!1===s||!a)return!1;Jn(t);var h={x:t.x,y:t.y};o=l?r.appendShape(n,o,h,a,{attach:u,connection:!0===l?{}:l}):rt(i=r.createElements(i,h,a,wt({},c,{attach:u})),function(t){return!tr(t)}),wt(e,{elements:i,shape:o}),wt(t,{elements:i,shape:o})}),this.start=function(t,n,r){Z(n)||(n=[n]);var o=rt(n,function(t){return!tr(t)});if(o){r=wt({elements:n,hints:{},shape:o},r||{}),it(n,function(t){J(t.x)||(t.x=0),J(t.y)||(t.y=0)});var i=jt(n);it(n,function(t){tr(t)&&(t.waypoints=st(t.waypoints,function(t){return{x:t.x-i.x-i.width/2,y:t.y-i.y-i.height/2}})),wt(t,{x:t.x-i.x-i.width/2,y:t.y-i.y-i.height/2})}),e.init(t,"create",{cursor:"grabbing",autoActivate:!0,data:{shape:o,elements:n,context:r}})}}}function Jn(t){var e=t.context.createConstraints;e&&(e.left&&(t.x=Math.max(t.x,e.left)),e.right&&(t.x=Math.min(t.x,e.right)),e.top&&(t.y=Math.max(t.y,e.top)),e.bottom&&(t.y=Math.min(t.y,e.bottom)))}function tr(t){return!!t.waypoints}function er(t){return t&&1===t.length&&!tr(t[0])}Qn.$inject=["canvas","dragging","eventBus","modeling","rules"];var nr=750;function rr(t,e,n,r,o){e.on("create.move",nr,function(e){var i=e.hover,a=e.context,c=a.elements,s=a.dragGroup;s||(s=a.dragGroup=function(t){var e=L("g");S(e,o.cls("djs-drag-group",["no-events"]));var i=L("g");return t.forEach(function(t){var o;t.waypoints?(o=n._createContainer("connection",i),n.drawConnection(se(o),t)):(o=n._createContainer("shape",i),n.drawShape(se(o),t),ue(o,t.x,t.y)),r.addDragger(t,e,o)}),e}(c)),i?(s.parentNode||_(t.getDefaultLayer(),s),ue(s,e.x,e.y)):B(s)}),e.on("create.cleanup",function(t){var e=t.context.dragGroup;e&&B(e)})}rr.$inject=["canvas","eventBus","graphicsFactory","previewSupport","styles"];var or={__depends__:[En,Un,un,cn],__init__:["create","createPreview"],create:["type",Qn],createPreview:["type",rr]};function ir(t,e){this._eventBus=t,this._dragging=e,this._tools=[],this._active=null}ir.$inject=["eventBus","dragging"],ir.prototype.registerTool=function(t,e){var n=this._tools;if(!e)throw new Error('A tool has to be registered with it\'s "events"');n.push(t),this.bindEvents(t,e)},ir.prototype.isActive=function(t){return t&&this._active===t},ir.prototype.length=function(t){return this._tools.length},ir.prototype.setActive=function(t){var e=this._eventBus;this._active!==t&&(this._active=t,e.fire("tool-manager.update",{tool:t}))},ir.prototype.bindEvents=function(t,e){var n=this._eventBus,r=this._dragging,o=[];n.on(e.tool+".init",function(e){if(!e.context.reactivate&&this.isActive(t))return this.setActive(null),void r.cancel();this.setActive(t)},this),it(e,function(t){o.push(t+".ended"),o.push(t+".canceled")}),n.on(o,250,function(t){var e=t.originalEvent;this._active&&(e&&be(e.target,'.group[data-group="tools"]')||this.setActive(null))},this)};var ar={__depends__:[En],__init__:["toolManager"],toolManager:["type",ir]};function cr(t,e,n,r,o,i){this._selection=o,this._dragging=n;var a=this,c=function(t){var n,r=e.getDefaultLayer();S(n=t.frame=L("rect"),{class:"djs-lasso-overlay",width:1,height:1,x:0,y:0}),_(r,n)},s=function(t){var e=t.frame,n=t.bbox;S(e,{x:n.x,y:n.y,width:n.width,height:n.height})},u=function(t){t.frame&&B(t.frame)};i.registerTool("lasso",{tool:"lasso.selection",dragging:"lasso"}),t.on("lasso.selection.end",function(e){var n=e.originalEvent.target;(e.hover||n instanceof SVGElement)&&t.once("lasso.selection.ended",function(){a.activateLasso(e.originalEvent,!0)})}),t.on("lasso.end",function(t){var e=sr(t),n=r.filter(function(t){return t});a.select(n,e)}),t.on("lasso.start",function(t){var e=t.context;e.bbox=sr(t),c(e)}),t.on("lasso.move",function(t){var e=t.context;e.bbox=sr(t),s(e)}),t.on("lasso.cleanup",function(t){var e=t.context;u(e)}),t.on("element.mousedown",1500,function(t){if(function(t){var e=Ie(t)||t;return We(t)&&e.shiftKey}(t))return a.activateLasso(t.originalEvent),!0})}function sr(t){var e={x:t.x-t.dx,y:t.y-t.dy},n={x:t.x,y:t.y};return e.x<=n.x&&e.y<n.y||e.x<n.x&&e.y<=n.y?{x:e.x,y:e.y,width:n.x-e.x,height:n.y-e.y}:e.x>=n.x&&e.y<n.y||e.x>n.x&&e.y<=n.y?{x:n.x,y:e.y,width:e.x-n.x,height:n.y-e.y}:e.x<=n.x&&e.y>n.y||e.x<n.x&&e.y>=n.y?{x:e.x,y:n.y,width:n.x-e.x,height:e.y-n.y}:e.x>=n.x&&e.y>n.y||e.x>n.x&&e.y>=n.y?{x:n.x,y:n.y,width:e.x-n.x,height:e.y-n.y}:{x:n.x,y:n.y,width:0,height:0}}cr.$inject=["eventBus","canvas","dragging","elementRegistry","selection","toolManager"],cr.prototype.activateLasso=function(t,e){this._dragging.init(t,"lasso",{autoActivate:e,cursor:"crosshair",data:{context:{}}})},cr.prototype.activateSelection=function(t){this._dragging.init(t,"lasso.selection",{trapClick:!1,cursor:"crosshair",data:{context:{}}})},cr.prototype.select=function(t,e){var n=function(t,e){var n={};return it(t,function(t){var r=t;r.waypoints&&(r=jt(r)),!J(e.y)&&r.x>e.x&&(n[t.id]=t),!J(e.x)&&r.y>e.y&&(n[t.id]=t),r.x>e.x&&r.y>e.y&&(J(e.width)&&J(e.height)&&r.width+r.x<e.width+e.x&&r.height+r.y<e.height+e.y?n[t.id]=t:J(e.width)&&J(e.height)||(n[t.id]=t))}),n}(t,e);this._selection.select(lt(n))},cr.prototype.toggle=function(){this.isActive()?this._dragging.cancel():this.activateSelection()},cr.prototype.isActive=function(){var t=this._dragging.context();return t&&/^lasso/.test(t.prefix)};var ur={__depends__:[ar],__init__:["lassoTool"],lassoTool:["type",cr]};function lr(t,e){this._handlerMap={},this._stack=[],this._stackIdx=-1,this._currentExecution={actions:[],dirty:[]},this._injector=e,this._eventBus=t,this._uid=1,t.on(["diagram.destroy","diagram.clear"],function(){this.clear(!1)},this)}lr.$inject=["eventBus","injector"],lr.prototype.execute=function(t,e){if(!t)throw new Error("command required");var n={command:t,context:e};this._pushAction(n),this._internalExecute(n),this._popAction(n)},lr.prototype.canExecute=function(t,e){var n={command:t,context:e},r=this._getHandler(t),o=this._fire(t,"canExecute",n);if(void 0===o){if(!r)return!1;r.canExecute&&(o=r.canExecute(e))}return o},lr.prototype.clear=function(t){this._stack.length=0,this._stackIdx=-1,!1!==t&&this._fire("changed")},lr.prototype.undo=function(){var t,e=this._getUndoAction();if(e){for(this._pushAction(e);e&&(this._internalUndo(e),(t=this._getUndoAction())&&t.id===e.id);)e=t;this._popAction()}},lr.prototype.redo=function(){var t,e=this._getRedoAction();if(e){for(this._pushAction(e);e&&(this._internalExecute(e,!0),(t=this._getRedoAction())&&t.id===e.id);)e=t;this._popAction()}},lr.prototype.register=function(t,e){this._setHandler(t,e)},lr.prototype.registerHandler=function(t,e){if(!t||!e)throw new Error("command and handlerCls must be defined");var n=this._injector.instantiate(e);this.register(t,n)},lr.prototype.canUndo=function(){return!!this._getUndoAction()},lr.prototype.canRedo=function(){return!!this._getRedoAction()},lr.prototype._getRedoAction=function(){return this._stack[this._stackIdx+1]},lr.prototype._getUndoAction=function(){return this._stack[this._stackIdx]},lr.prototype._internalUndo=function(t){var e=this,n=t.command,r=t.context,o=this._getHandler(n);this._atomicDo(function(){e._fire(n,"revert",t),o.revert&&e._markDirty(o.revert(r)),e._revertedAction(t),e._fire(n,"reverted",t)})},lr.prototype._fire=function(t,e,n){arguments.length<3&&(n=e,e=null);var r,o,i,a=e?[t+"."+e,e]:[t];for(n=this._eventBus.createEvent(n),r=0;(o=a[r])&&(i=this._eventBus.fire("commandStack."+o,n),!n.cancelBubble);r++);return i},lr.prototype._createId=function(){return this._uid++},lr.prototype._atomicDo=function(t){var e=this._currentExecution;e.atomic=!0;try{t()}finally{e.atomic=!1}},lr.prototype._internalExecute=function(t,e){var n=this,r=t.command,o=t.context,i=this._getHandler(r);if(!i)throw new Error("no command handler registered for <"+r+">");this._pushAction(t),e||(this._fire(r,"preExecute",t),i.preExecute&&i.preExecute(o),this._fire(r,"preExecuted",t)),this._atomicDo(function(){n._fire(r,"execute",t),i.execute&&n._markDirty(i.execute(o)),n._executedAction(t,e),n._fire(r,"executed",t)}),e||(this._fire(r,"postExecute",t),i.postExecute&&i.postExecute(o),this._fire(r,"postExecuted",t)),this._popAction(t)},lr.prototype._pushAction=function(t){var e=this._currentExecution,n=e.actions,r=n[0];if(e.atomic)throw new Error("illegal invocation in <execute> or <revert> phase (action: "+t.command+")");t.id||(t.id=r&&r.id||this._createId()),n.push(t)},lr.prototype._popAction=function(){var t=this._currentExecution,e=t.actions,n=t.dirty;e.pop(),e.length||(this._eventBus.fire("elements.changed",{elements:pt("id",n)}),n.length=0,this._fire("changed"))},lr.prototype._markDirty=function(t){var e=this._currentExecution;t&&(t=Z(t)?t:[t],e.dirty=e.dirty.concat(t))},lr.prototype._executedAction=function(t,e){var n=++this._stackIdx;e||this._stack.splice(n,this._stack.length,t)},lr.prototype._revertedAction=function(t){this._stackIdx--},lr.prototype._getHandler=function(t){return this._handlerMap[t]},lr.prototype._setHandler=function(t,e){if(!t||!e)throw new Error("command and handler required");if(this._handlerMap[t])throw new Error("overriding handler for command <"+t+">");this._handlerMap[t]=e};var hr={commandStack:["type",lr]};function pr(t,e,n,r){t.on("element.changed",function(r){var o=r.element;(o.parent||o===e.getRootElement())&&(r.gfx=n.getGraphics(o)),r.gfx&&t.fire(Mt(o)+".changed",r)}),t.on("elements.changed",function(e){var n=e.elements;n.forEach(function(e){t.fire("element.changed",{element:e})}),r.updateContainments(n)}),t.on("shape.changed",function(t){r.update("shape",t.element,t.gfx)}),t.on("connection.changed",function(t){r.update("connection",t.element,t.gfx)})}pr.$inject=["eventBus","canvas","elementRegistry","graphicsFactory"];var dr={__init__:["changeSupport"],changeSupport:["type",pr]};function fr(t,e){this._modeling=t,this._canvas=e}function vr(t){this._modeling=t}function yr(t,e){this._canvas=t,this._layouter=e}fr.$inject=["modeling","canvas"],fr.prototype.preExecute=function(t){var e=this._modeling,n=t.elements,r=t.alignment;it(n,function(t){var n={x:0,y:0};r.left?n.x=r.left-t.x:r.right?n.x=r.right-t.width-t.x:r.center?n.x=r.center-Math.round(t.width/2)-t.x:r.top?n.y=r.top-t.y:r.bottom?n.y=r.bottom-t.height-t.y:r.middle&&(n.y=r.middle-Math.round(t.height/2)-t.y),e.moveElements([t],n,t.parent)})},fr.prototype.postExecute=function(t){},vr.$inject=["modeling"],vr.prototype.preExecute=function(t){var e=t.source;if(!e)throw new Error("source required");var n=t.target||e.parent,r=t.shape;r=t.shape=this._modeling.createShape(r,t.position,n,{attach:t.attach}),t.shape=r},vr.prototype.postExecute=function(t){var e,n,r=t.connectionParent||t.shape.parent;e=t.source,n=t.shape,rt(e.outgoing,function(t){return t.target===n})||this._modeling.connect(t.source,t.shape,t.connection,r)},yr.$inject=["canvas","layouter"],yr.prototype.execute=function(t){var e=t.connection,n=t.source,r=t.target,o=t.parent,i=t.parentIndex,a=t.hints;if(!n||!r)throw new Error("source and target required");if(!o)throw new Error("parent required");return e.source=n,e.target=r,e.waypoints||(e.waypoints=this._layouter.layoutConnection(e,a)),this._canvas.addConnection(e,o,i),e},yr.prototype.revert=function(t){var e=t.connection;this._canvas.removeConnection(e),e.source=null,e.target=null};var gr=Math.round;function mr(t){this._modeling=t}function xr(t){return!!t.waypoints}mr.$inject=["modeling"],mr.prototype.preExecute=function(t){var e=t.elements,n=t.parent,r=t.parentIndex,o=t.position,i=t.hints,a=this._modeling;it(e,function(t){J(t.x)||(t.x=0),J(t.y)||(t.y=0)});var c=jt(e);it(e,function(t){xr(t)&&(t.waypoints=st(t.waypoints,function(t){return{x:gr(t.x-c.x-c.width/2+o.x),y:gr(t.y-c.y-c.height/2+o.y)}})),wt(t,{x:gr(t.x-c.x-c.width/2+o.x),y:gr(t.y-c.y-c.height/2+o.y)})});var s=Et(e),u={};it(e,function(t){if(xr(t))u[t.id]=J(r)?a.createConnection(u[t.source.id],u[t.target.id],r,t,t.parent||n,i):a.createConnection(u[t.source.id],u[t.target.id],t,t.parent||n,i);else{var e=wt({},i);-1===s.indexOf(t)&&(e.autoResize=!1),u[t.id]=J(r)?a.createShape(t,bt(t,["x","y","width","height"]),t.parent||n,r,e):a.createShape(t,bt(t,["x","y","width","height"]),t.parent||n,e)}}),t.elements=lt(u)};var _r=Math.round;function wr(t){this._canvas=t}function br(t){wr.call(this,t)}wr.$inject=["canvas"],wr.prototype.execute=function(t){var e=t.shape,n=t.position,r=t.parent,o=t.parentIndex;if(!r)throw new Error("parent required");if(!n)throw new Error("position required");return void 0!==n.width?wt(e,n):wt(e,{x:n.x-_r(e.width/2),y:n.y-_r(e.height/2)}),this._canvas.addShape(e,r,o),e},wr.prototype.revert=function(t){this._canvas.removeShape(t.shape)},v()(br,wr),br.$inject=["canvas"];var Er=wr.prototype.execute;br.prototype.execute=function(t){var e=t.shape;return function(t){["width","height"].forEach(function(e){void 0===t[e]&&(t[e]=0)})}(e),e.labelTarget=t.labelTarget,Er.call(this,t)};var Sr=wr.prototype.revert;function Cr(t,e){this._canvas=t,this._modeling=e}function kr(t,e){this._modeling=t,this._elementRegistry=e}function jr(t,e){if("function"!=typeof e)throw new Error("removeFn iterator must be a function");if(t){for(var n;n=t[0];)e(n);return t}}function Mr(t,e){this._canvas=t,this._modeling=e}function Or(t){this._modeling=t}br.prototype.revert=function(t){return t.shape.labelTarget=null,Sr.call(this,t)},Cr.$inject=["canvas","modeling"],Cr.prototype.execute=function(t){var e=t.connection,n=e.parent;return t.parent=n,t.parentIndex=$t(n.children,e),t.source=e.source,t.target=e.target,this._canvas.removeConnection(e),e.source=null,e.target=null,e},Cr.prototype.revert=function(t){var e=t.connection,n=t.parent,r=t.parentIndex;return e.source=t.source,e.target=t.target,Tt(n.children,e,r),this._canvas.addConnection(e,n),e},kr.$inject=["modeling","elementRegistry"],kr.prototype.postExecute=function(t){var e=this._modeling,n=this._elementRegistry;it(t.elements,function(t){n.get(t.id)&&(t.waypoints?e.removeConnection(t):e.removeShape(t))})},Mr.$inject=["canvas","modeling"],Mr.prototype.preExecute=function(t){var e=this._modeling,n=t.shape;jr(n.incoming,function(t){e.removeConnection(t,{nested:!0})}),jr(n.outgoing,function(t){e.removeConnection(t,{nested:!0})}),jr(n.children,function(t){t.waypoints?e.removeConnection(t,{nested:!0}):e.removeShape(t,{nested:!0})})},Mr.prototype.execute=function(t){var e=this._canvas,n=t.shape,r=n.parent;return t.oldParent=r,t.oldParentIndex=$t(r.children,n),e.removeShape(n),n},Mr.prototype.revert=function(t){var e=this._canvas,n=t.shape,r=t.oldParent,o=t.oldParentIndex;return Tt(r.children,n,o),e.addShape(n,r),n},Or.$inject=["modeling"];var Pr={x:"y",y:"x"};function Br(t,e){this._layouter=t,this._canvas=e}function Rr(){}function Ar(t,e,n){var r=vn(e),o=vn(n),i=yn(t,r),a=i.x*(n.width/e.width),c=i.y*(n.height/e.height);return Sn({x:o.x+a,y:o.y+c})}function zr(t,e,n){var r=Nr(t)[0];return Ar(r.original||r,n,e)}function Tr(t,e,n){var r=Nr(t),o=r[r.length-1];return Ar(o.original||o,n,e)}function $r(t,e,n){return zr(t,e,Dr(e,n))}function Lr(t,e,n){return Tr(t,e,Dr(e,n))}function Dr(t,e){return{x:t.x-e.x,y:t.y-e.y,width:t.width,height:t.height}}function Nr(t){var e=t.waypoints;if(!e.length)throw new Error("connection#"+t.id+": no waypoints");return e}function Fr(){this.allShapes={},this.allConnections={},this.enclosedElements={},this.enclosedConnections={},this.topLevel={}}function Hr(t){this._modeling=t}function Gr(t){this._helper=new Hr(t)}function Ir(t){this._modeling=t,this._helper=new Hr(t)}function Vr(t){this._modeling=t}function qr(t,e){this._modeling=t,this._rules=e}function Wr(t){this._modeling=t}function Ur(t){this._modeling=t}function Yr(t){this._modeling=t}function Kr(t){this._modeling=t}function Xr(t,e){return zt(t&&t.attachers,e)}function Zr(t,e,n){if(t){var r=t.attachers;r||(t.attachers=r=[]),Tt(r,e,n)}}function Qr(){}function Jr(t,e,n){this._eventBus=t,this._elementFactory=e,this._commandStack=n;var r=this;t.on("diagram.init",function(){r.registerHandlers(n)})}function to(){}Or.prototype.preExecute=function(t){var e=this._modeling,n=t.groups,r=t.axis,o=t.dimension;function i(t,e){t.range.min=Math.min(e[r],t.range.min),t.range.max=Math.max(e[r]+e[o],t.range.max)}function a(t){return t[r]+t[o]/2}function c(t){return t.length-1}function s(t){return t.max-t.min}var u,l,h=n[0],p=c(n),d=n[p],f=0;it(n,function(t,u){var l,h,d;t.elements.length<2?u&&u!==n.length-1&&(i(t,t.elements[0]),f+=s(t.range)):(h=(l=dt(t.elements,r))[0],u===p&&(h=l[c(l)]),d=a(h),t.range=null,it(l,function(n){!function(t,n){var o={y:0};o[r]=t-a(n),o[r]&&(o[Pr[r]]=0,e.moveElements([n],o,n.parent))}(d,n),null!==t.range?i(t,n):t.range={min:n[r],max:n[r]+n[o]}}),u&&u!==n.length-1&&(f+=s(t.range)))}),l=Math.abs(d.range.min-h.range.max),(u=Math.round((l-f)/(n.length-1)))<n.length-1||it(n,function(t,i){var a,c={};t!==h&&t!==d&&(a=n[i-1],t.range.max=0,it(t.elements,function(n,i){c[Pr[r]]=0,c[r]=a.range.max-n[r]+u,t.range.min!==n[r]&&(c[r]+=n[r]-t.range.min),c[r]&&e.moveElements([n],c,n.parent),t.range.max=Math.max(n[r]+n[o],i?t.range.max:0)}))})},Or.prototype.postExecute=function(t){},Br.$inject=["layouter","canvas"],Br.prototype.execute=function(t){var e=t.connection;return wt(t,{oldWaypoints:e.waypoints}),e.waypoints=this._layouter.layoutConnection(e,t.hints),e},Br.prototype.revert=function(t){var e=t.connection;return e.waypoints=t.oldWaypoints,e},Rr.prototype.execute=function(t){var e=t.connection,n=t.delta,r=t.newParent||e.parent,o=t.newParentIndex,i=e.parent;return t.oldParent=i,t.oldParentIndex=zt(i.children,e),Tt(r.children,e,o),e.parent=r,it(e.waypoints,function(t){t.x+=n.x,t.y+=n.y,t.original&&(t.original.x+=n.x,t.original.y+=n.y)}),e},Rr.prototype.revert=function(t){var e=t.connection,n=e.parent,r=t.oldParent,o=t.oldParentIndex,i=t.delta;return zt(n.children,e),Tt(r.children,e,o),e.parent=r,it(e.waypoints,function(t){t.x-=i.x,t.y-=i.y,t.original&&(t.original.x-=i.x,t.original.y-=i.y)}),e},Fr.prototype.add=function(t,e){return this.addAll([t],e)},Fr.prototype.addAll=function(t,e){return wt(this,function(t,e,n){K(e)&&(e=!0),Q(e)&&(n=e,e=!0);var r=Pt((n=n||{}).allShapes),o=Pt(n.allConnections),i=Pt(n.enclosedElements),a=Pt(n.enclosedConnections),c=Pt(n.topLevel,e&&ht(t,function(t){return t.id}));function s(t){c[t.source.id]&&c[t.target.id]&&(c[t.id]=[t]),r[t.source.id]&&r[t.target.id]&&(a[t.id]=i[t.id]=t),o[t.id]=t}return Ct(t,function(t){if(i[t.id]=t,!t.waypoints)return r[t.id]=t,it(t.incoming,s),it(t.outgoing,s),t.children;a[t.id]=o[t.id]=t}),{allShapes:r,allConnections:o,topLevel:c,enclosedConnections:a,enclosedElements:i}}(t,!!e,this)),this},Hr.prototype.moveRecursive=function(t,e,n){return t?this.moveClosure(this.getClosure(t),e,n):[]},Hr.prototype.moveClosure=function(t,e,n,r,o){var i=this._modeling,a=t.allShapes,c=t.allConnections,s=t.enclosedConnections,u=t.topLevel,l=!1;o&&o.parent===n&&(l=!0),it(a,function(t){i.moveShape(t,e,u[t.id]&&!l&&n,{recurse:!1,layout:!1})}),it(c,function(t){var r=!!a[t.source.id],o=!!a[t.target.id];s[t.id]&&r&&o?i.moveConnection(t,e,u[t.id]&&!l&&n):i.layoutConnection(t,{connectionStart:r&&$r(t,t.source,e),connectionEnd:o&&Lr(t,t.target,e)})})},Hr.prototype.getClosure=function(t){return(new Fr).addAll(t,!0)},Gr.$inject=["modeling"],Gr.prototype.preExecute=function(t){t.closure=this._helper.getClosure(t.shapes)},Gr.prototype.postExecute=function(t){var e,n=t.hints;n&&n.primaryShape&&(e=n.primaryShape,n.oldParent=e.parent),this._helper.moveClosure(t.closure,t.delta,t.newParent,t.newHost,e)},Ir.$inject=["modeling"],Ir.prototype.execute=function(t){var e=t.shape,n=t.delta,r=t.newParent||e.parent,o=t.newParentIndex,i=e.parent;return t.oldBounds=bt(e,["x","y","width","height"]),t.oldParent=i,t.oldParentIndex=zt(i.children,e),Tt(r.children,e,o),wt(e,{parent:r,x:e.x+n.x,y:e.y+n.y}),e},Ir.prototype.postExecute=function(t){var e=t.shape,n=t.delta,r=t.hints,o=this._modeling;!1!==r.layout&&(it(e.incoming,function(t){o.layoutConnection(t,{connectionEnd:Lr(t,e,n)})}),it(e.outgoing,function(t){o.layoutConnection(t,{connectionStart:$r(t,e,n)})})),!1!==r.recurse&&this.moveChildren(t)},Ir.prototype.revert=function(t){var e=t.shape,n=t.oldParent,r=t.oldParentIndex,o=t.delta;return Tt(n.children,e,r),wt(e,{parent:n,x:e.x-o.x,y:e.y-o.y}),e},Ir.prototype.moveChildren=function(t){var e=t.delta,n=t.shape;this._helper.moveRecursive(n.children,e,null)},Ir.prototype.getNewParent=function(t){return t.newParent||t.shape.parent},Vr.$inject=["modeling"],Vr.prototype.execute=function(t){var e=t.newSource,n=t.newTarget,r=t.connection,o=t.dockingOrPoints;if(!e&&!n)throw new Error("newSource or newTarget are required");if(e&&n)throw new Error("must specify either newSource or newTarget");return Z(o)&&(t.oldWaypoints=r.waypoints,r.waypoints=o),e&&(t.oldSource=r.source,r.source=e),n&&(t.oldTarget=r.target,r.target=n),r},Vr.prototype.postExecute=function(t){var e,n,r=t.connection,o=t.dockingOrPoints,i=t.newSource,a=i?"connectionStart":"connectionEnd",c={};!1!==t.hints.layoutConnection&&(e=Z(o)?i?o[0]:o[o.length-1]:o,c[a]=(n=e).original||n,this._modeling.layoutConnection(r,c))},Vr.prototype.revert=function(t){var e=t.oldSource,n=t.oldTarget,r=t.oldWaypoints,o=t.connection;return e&&(o.source=e),n&&(o.target=n),r&&(o.waypoints=r),o},qr.$inject=["modeling","rules"],qr.prototype.preExecute=function(t){var e,n=this,r=this._modeling,o=this._rules,i=t.oldShape,a=t.newData,c=t.hints;function s(t,e,n,r){return o.allowed(t,{source:e,target:n,connection:r})}var u,l={x:a.x,y:a.y};e=t.newShape=t.newShape||n.createShape(a,l,i.parent,c),i.host&&r.updateAttachment(e,i.host),!1!==c.moveChildren&&(u=i.children.slice(),r.moveElements(u,{x:0,y:0},e));var h=i.incoming.slice(),p=i.outgoing.slice();it(h,function(t){var r=t.waypoints,o=r[r.length-1];s("connection.reconnectEnd",t.source,e,t)&&n.reconnectEnd(t,e,o,{layoutConnection:c.layoutConnection})}),it(p,function(t){var r=t.waypoints[0],o=t.target;s("connection.reconnectStart",e,o,t)&&n.reconnectStart(t,e,r,{layoutConnection:c.layoutConnection})})},qr.prototype.postExecute=function(t){var e=this._modeling,n=t.oldShape,r=t.newShape;!1!==t.hints.layoutConnection&&(it(r.incoming,function(t){e.layoutConnection(t,{endChanged:!0})}),it(r.outgoing,function(t){e.layoutConnection(t,{startChanged:!0})})),e.removeShape(n)},qr.prototype.execute=function(t){},qr.prototype.revert=function(t){},qr.prototype.createShape=function(t,e,n,r){return this._modeling.createShape(t,e,n,r)},qr.prototype.reconnectStart=function(t,e,n,r){this._modeling.reconnectStart(t,e,n,r)},qr.prototype.reconnectEnd=function(t,e,n,r){this._modeling.reconnectEnd(t,e,n,r)},Wr.$inject=["modeling"],Wr.prototype.execute=function(t){var e=t.shape,n=t.newBounds,r=t.minBounds;if(void 0===n.x||void 0===n.y||void 0===n.width||void 0===n.height)throw new Error("newBounds must have {x, y, width, height} properties");if(r&&(n.width<r.width||n.height<r.height))throw new Error("width and height cannot be less than minimum height and width");if(!r&&n.width<10||n.height<10)throw new Error("width and height cannot be less than 10px");return t.oldBounds={width:e.width,height:e.height,x:e.x,y:e.y},wt(e,{width:n.width,height:n.height,x:n.x,y:n.y}),e},Wr.prototype.postExecute=function(t){var e=t.shape,n=t.oldBounds,r=this._modeling;it(e.incoming,function(t){r.layoutConnection(t,{connectionEnd:Tr(t,e,n)})}),it(e.outgoing,function(t){r.layoutConnection(t,{connectionStart:zr(t,e,n)})})},Wr.prototype.revert=function(t){var e=t.shape,n=t.oldBounds;return wt(e,{width:n.width,height:n.height,x:n.x,y:n.y}),e},Ur.$inject=["modeling"],Ur.prototype.preExecute=function(t){var e=this._modeling,n=t.resizingShapes,r=t.delta,o=t.direction;it(n,function(t){var n=function(t,e,n){var r=n.x,o=n.y;switch(e){case"n":return{x:t.x,y:t.y+o,width:t.width,height:t.height-o};case"s":return{x:t.x,y:t.y,width:t.width,height:t.height+o};case"w":return{x:t.x+r,y:t.y,width:t.width-r,height:t.height};case"e":return{x:t.x,y:t.y,width:t.width+r,height:t.height};default:throw new Error("unrecognized direction: "+e)}}(t,o,r);e.resizeShape(t,n)})},Ur.prototype.postExecute=function(t){var e=this._modeling,n=t.movingShapes,r=t.delta;e.moveElements(n,r,void 0,{autoResize:!1,attach:!1})},Ur.prototype.execute=function(t){},Ur.prototype.revert=function(t){},Yr.$inject=["modeling"],Yr.prototype.execute=function(t){var e,n=t.shape,r=n.children;return t.oldChildrenVisibility=(e={},r.forEach(function(t){e[t.id]=t.hidden}),e),n.collapsed=!n.collapsed,function(t,e){t.forEach(function(t){t.hidden=e})}(r,n.collapsed),[n].concat(r)},Yr.prototype.revert=function(t){var e,n=t.shape,r=t.oldChildrenVisibility,o=n.children;return e=r,o.forEach(function(t){t.hidden=e[t.id]}),n.collapsed=!n.collapsed,[n].concat(o)},Kr.$inject=["modeling"],Kr.prototype.execute=function(t){var e=t.shape,n=t.newHost,r=e.host;return t.oldHost=r,t.attacherIdx=Xr(r,e),Zr(n,e),e.host=n,e},Kr.prototype.revert=function(t){var e=t.shape,n=t.newHost,r=t.oldHost,o=t.attacherIdx;return e.host=r,Xr(n,e),Zr(r,e,o),e},Qr.prototype.execute=function(t){var e=t.connection,n=t.newWaypoints;return t.oldWaypoints=e.waypoints,e.waypoints=n,e},Qr.prototype.revert=function(t){var e=t.connection,n=t.oldWaypoints;return e.waypoints=n,e},Jr.$inject=["eventBus","elementFactory","commandStack"],Jr.prototype.getHandlers=function(){return{"shape.append":vr,"shape.create":wr,"shape.delete":Mr,"shape.move":Ir,"shape.resize":Wr,"shape.replace":qr,"shape.toggleCollapse":Yr,spaceTool:Ur,"label.create":br,"connection.create":yr,"connection.delete":Cr,"connection.move":Rr,"connection.layout":Br,"connection.updateWaypoints":Qr,"connection.reconnectStart":Vr,"connection.reconnectEnd":Vr,"elements.create":mr,"elements.move":Gr,"elements.delete":kr,"elements.distribute":Or,"elements.align":fr,"element.updateAttachment":Kr}},Jr.prototype.registerHandlers=function(t){it(this.getHandlers(),function(e,n){t.registerHandler(n,e)})},Jr.prototype.moveShape=function(t,e,n,r,o){"object"==typeof r&&(o=r,r=null);var i={shape:t,delta:e,newParent:n,newParentIndex:r,hints:o||{}};this._commandStack.execute("shape.move",i)},Jr.prototype.updateAttachment=function(t,e){var n={shape:t,newHost:e};this._commandStack.execute("element.updateAttachment",n)},Jr.prototype.moveElements=function(t,e,n,r){var o,i=(r=r||{}).attach,a=n;!0===i?(o=n,a=n.parent):!1===i&&(o=null);var c={shapes:t,delta:e,newParent:a,newHost:o,hints:r};this._commandStack.execute("elements.move",c)},Jr.prototype.moveConnection=function(t,e,n,r,o){"object"==typeof r&&(o=r,r=void 0);var i={connection:t,delta:e,newParent:n,newParentIndex:r,hints:o||{}};this._commandStack.execute("connection.move",i)},Jr.prototype.layoutConnection=function(t,e){var n={connection:t,hints:e||{}};this._commandStack.execute("connection.layout",n)},Jr.prototype.createConnection=function(t,e,n,r,o,i){"object"==typeof n&&(i=o,o=r,r=n,n=void 0);var a={source:t,target:e,parent:o,parentIndex:n,connection:r=this._create("connection",r),hints:i};return this._commandStack.execute("connection.create",a),a.connection},Jr.prototype.createShape=function(t,e,n,r,o){"number"!=typeof r&&(o=r,r=void 0);var i,a,c=(o=o||{}).attach;t=this._create("shape",t),c?(i=n.parent,a=n):i=n;var s={position:e,shape:t,parent:i,parentIndex:r,host:a,hints:o};return this._commandStack.execute("shape.create",s),s.shape},Jr.prototype.createElements=function(t,e,n,r,o){Z(t)||(t=[t]),"number"!=typeof r&&(o=r,r=void 0);var i={position:e,elements:t,parent:n,parentIndex:r,hints:o=o||{}};return this._commandStack.execute("elements.create",i),i.elements},Jr.prototype.createLabel=function(t,e,n,r){n=this._create("label",n);var o={labelTarget:t,position:e,parent:r||t.parent,shape:n};return this._commandStack.execute("label.create",o),o.shape},Jr.prototype.appendShape=function(t,e,n,r,o){o=o||{};var i={source:t,position:n,target:r,shape:e=this._create("shape",e),connection:o.connection,connectionParent:o.connectionParent,attach:o.attach};return this._commandStack.execute("shape.append",i),i.shape},Jr.prototype.removeElements=function(t){var e={elements:t};this._commandStack.execute("elements.delete",e)},Jr.prototype.distributeElements=function(t,e,n){var r={groups:t,axis:e,dimension:n};this._commandStack.execute("elements.distribute",r)},Jr.prototype.removeShape=function(t,e){var n={shape:t,hints:e||{}};this._commandStack.execute("shape.delete",n)},Jr.prototype.removeConnection=function(t,e){var n={connection:t,hints:e||{}};this._commandStack.execute("connection.delete",n)},Jr.prototype.replaceShape=function(t,e,n){var r={oldShape:t,newData:e,hints:n||{}};return this._commandStack.execute("shape.replace",r),r.newShape},Jr.prototype.alignElements=function(t,e){var n={elements:t,alignment:e};this._commandStack.execute("elements.align",n)},Jr.prototype.resizeShape=function(t,e,n,r){var o={shape:t,newBounds:e,minBounds:n,hints:r};this._commandStack.execute("shape.resize",o)},Jr.prototype.createSpace=function(t,e,n,r){var o={movingShapes:t,resizingShapes:e,delta:n,direction:r};this._commandStack.execute("spaceTool",o)},Jr.prototype.updateWaypoints=function(t,e,n){var r={connection:t,newWaypoints:e,hints:n||{}};this._commandStack.execute("connection.updateWaypoints",r)},Jr.prototype.reconnectStart=function(t,e,n,r){var o={connection:t,newSource:e,dockingOrPoints:n,hints:r||{}};this._commandStack.execute("connection.reconnectStart",o)},Jr.prototype.reconnectEnd=function(t,e,n,r){var o={connection:t,newTarget:e,dockingOrPoints:n,hints:r||{}};this._commandStack.execute("connection.reconnectEnd",o)},Jr.prototype.connect=function(t,e,n,r){return this.createConnection(t,e,n||{},t.parent,r)},Jr.prototype._create=function(t,e){return e instanceof Qt?e:this._elementFactory.create(t,e)},Jr.prototype.toggleCollapse=function(t,e){var n={shape:t,hints:e||{}};this._commandStack.execute("shape.toggleCollapse",n)},to.prototype.layoutConnection=function(t,e){return[(e=e||{}).connectionStart||jn(e.source||t.source),e.connectionEnd||jn(e.target||t.target)]};var eo={__depends__:[hr,dr,cn,un],__init__:["modeling"],modeling:["type",Jr],layouter:["type",to]},no=15;function ro(t,e){var n;function r(r){var o,i=n.start,a=qe(r),c=yn(a,i);(!n.dragging&&(o=c,Math.sqrt(Math.pow(o.x,2)+Math.pow(o.y,2))>no)&&(n.dragging=!0,fn(t),hn("grab")),n.dragging)&&(c=yn(a,n.last||n.start),e.scroll({dx:c.x,dy:c.y}),n.last=a);r.preventDefault()}function o(t){ke.unbind(document,"mousemove",r),ke.unbind(document,"mouseup",o),n=null,pn()}t.on("element.mousedown",500,function(t){return function(t){if(be(t.target,".djs-draggable"))return;if(t.button||t.ctrlKey||t.shiftKey||t.altKey)return;return n={start:qe(t)},ke.bind(document,"mousemove",r),ke.bind(document,"mouseup",o),!0}(t.originalEvent)})}ro.$inject=["eventBus","canvas"];var oo={__init__:["moveCanvas"],moveCanvas:["type",ro]},io=500,ao=1250,co=1500,so=Math.round;function uo(t,e,n,r,o){function i(t,e,n,r){return o.allowed("elements.move",{shapes:t,delta:e,position:n,target:r})}function a(t,n,r,o){if(Q(r)&&(o=r,r=!1),!n.waypoints&&n.parent){var i=function(t){return{x:t.x+so(t.width/2),y:t.y+so(t.height/2)}}(n);return e.init(t,i,"shape.move",{cursor:"grabbing",autoActivate:r,data:{shape:n,context:o||{}}}),!0}}t.on("shape.move.start",co,function(t){var e,n,o=t.context,i=t.shape,a=r.get().slice();-1===a.indexOf(i)&&(a=[i]),n=ht(e=a,"id"),wt(o,{shapes:a=ot(e,function(t){for(;t=t.parent;)if(n[t.id])return!1;return!0}),validatedShapes:a,shape:i})}),t.on("shape.move.start",ao,function(t){var e=t.context,n=e.validatedShapes;if(!(e.canExecute=i(n)))return!1}),t.on("shape.move.move",io,function(t){var e,n=t.context,r=n.validatedShapes,o=t.hover,a={x:t.dx,y:t.dy};e=i(r,a,{x:t.x,y:t.y},o),n.delta=a,n.canExecute=e,n.target=null!==e?o:null}),t.on("shape.move.end",function(t){var e=t.context,r=e.delta,o=e.canExecute,i="attach"===o,a=e.shapes;if(!1===o)return!1;r.x=so(r.x),r.y=so(r.y),0===r.x&&0===r.y||n.moveElements(a,r,e.target,{primaryShape:e.shape,attach:i})}),t.on("element.mousedown",function(t){var e=Ie(t);if(!e)throw new Error("must supply DOM mousedown event");return a(e,t.element)}),this.start=a}uo.$inject=["eventBus","dragging","modeling","selection","rules"];var lo=499,ho="djs-dragging",po="drop-ok",fo="drop-not-ok",vo="new-parent",yo="attach-ok";function go(t,e,n,r){function o(t){return function(t){return ot(t,function(e){return!function(t){return t.waypoints}(e)||rt(t,ft({id:e.source.id}))&&rt(t,ft({id:e.target.id}))})}(i(t))}function i(t){var e=kt(t,!!0,-1),n=st(e,function(t){return(t.incoming||[]).concat(t.outgoing||[])});return W(e.concat(n))}function a(t,n){[yo,po,fo,vo].forEach(function(r){r===n?e.addMarker(t,r):e.removeMarker(t,r)})}t.on("shape.move.start",lo,function(t){var a=t.context,c=a.shapes,s=a.allDraggedElements,u=o(c);if(!a.dragGroup){var l=L("g");S(l,n.cls("djs-drag-group",["no-events"])),_(e.getDefaultLayer(),l),a.dragGroup=l}u.forEach(function(t){r.addDragger(t,a.dragGroup)}),it(s=s?W([s,i(c)]):i(c),function(t){e.addMarker(t,ho)}),a.allDraggedElements=s,a.differentParents=1!==ut(ht(c,function(t){return t.parent&&t.parent.id}))}),t.on("shape.move.move",lo,function(t){var e=t.context,n=e.dragGroup,r=e.target,o=e.shape.parent,i=e.canExecute;r&&("attach"===i?a(r,yo):e.canExecute&&r&&r.id!==o.id?a(r,vo):a(r,e.canExecute?po:fo)),ue(n,t.dx,t.dy)}),t.on(["shape.move.out","shape.move.cleanup"],function(t){var e=t.context.target;e&&a(e,null)}),t.on("shape.move.cleanup",function(t){var n=t.context,r=n.allDraggedElements,o=n.dragGroup;it(r,function(t){e.removeMarker(t,ho)}),o&&B(o)}),this.makeDraggable=function(t,n,o){r.addDragger(n,t.dragGroup),o&&e.addMarker(n,ho),t.allDraggedElements?t.allDraggedElements.push(n):t.allDraggedElements=[n]}}go.$inject=["eventBus","canvas","styles","previewSupport"];var mo={__depends__:[Ze,cn,tn,un,En,Un],__init__:["move","movePreview"],move:["type",uo],movePreview:["type",go]};function xo(t,e){this._eventBus=t,this._canvas=e,this._providers=[];var n=this;t.on("tool-manager.update",function(t){var e=t.tool;n.updateToolHighlight(e)}),t.on("i18n.changed",function(){n._update()}),t.on("diagram.init",function(){n._diagramInitialized=!0,n._providers.length&&(n._init(),n._update())})}xo.$inject=["eventBus","canvas"],xo.prototype.registerProvider=function(t){this._providers.push(t),this._diagramInitialized&&(this._container||this._init(),this._update())},xo.prototype.getEntries=function(){var t={};return it(this._providers,function(e){it(e.getPaletteEntries(),function(e,n){t[n]=e})}),t},xo.prototype._init=function(){var t=this,e=this._eventBus,n=this._getParentContainer(),r=this._container=Oe(xo.HTML_MARKUP);n.appendChild(r),Me.bind(r,".djs-palette-toggle, .entry","click",function(e){var n=e.delegateTarget;if(ze(n,".djs-palette-toggle"))return t.toggle();t.trigger("click",e)}),ke.bind(r,"mousedown",function(t){t.stopPropagation()}),Me.bind(r,".entry","dragstart",function(e){t.trigger("dragstart",e)}),e.on("canvas.resized",this._layoutChanged,this),e.fire("palette.create",{container:r})},xo.prototype._toggleState=function(t){t=t||{};var e,n=this._getParentContainer(),r=this._container,o=this._eventBus,i=ve(r);e="twoColumn"in t?t.twoColumn:this._needsCollapse(n.clientHeight,this._entries||{}),i.toggle("two-column",e),"open"in t&&i.toggle("open",t.open),o.fire("palette.changed",{twoColumn:e,open:this.isOpen()})},xo.prototype._update=function(){var t=Te(".djs-palette-entries",this._container),e=this._entries=this.getEntries();ge(t),it(e,function(e,n){var r=e.group||"default",o=Te("[data-group="+r+"]",t);o||(o=Oe('<div class="group" data-group="'+r+'"></div>'),t.appendChild(o));var i,a,c,s=e.html||(e.separator?'<hr class="separator" />':'<div class="entry" draggable="true"></div>'),u=Oe(s);o.appendChild(u),e.separator||(le(u,"data-action",n),e.title&&le(u,"title",e.title),e.className&&(i=u,a=e.className,c=ve(i),(Z(a)?a:a.split(/\s+/g)).forEach(function(t){c.add(t)})),e.imageUrl&&u.appendChild(Oe('<img src="'+e.imageUrl+'">')))}),this.open()},xo.prototype.trigger=function(t,e,n){var r,o,i,a=this._entries,c=e.delegateTarget||e.target;if(!c)return e.preventDefault();(r=a[le(c,"data-action")])&&(o=r.action,i=e.originalEvent||e,tt(o)?"click"===t&&o(i,n):o[t]&&o[t](i,n),e.preventDefault())},xo.prototype._layoutChanged=function(){this._toggleState({})},xo.prototype._needsCollapse=function(t,e){return t<46*Object.keys(e).length+50},xo.prototype.close=function(){this._toggleState({open:!1,twoColumn:!1})},xo.prototype.open=function(){this._toggleState({open:!0})},xo.prototype.toggle=function(t){this.isOpen()?this.close():this.open()},xo.prototype.isActiveTool=function(t){return t&&this._activeTool===t},xo.prototype.updateToolHighlight=function(t){var e;this._toolsContainer||(e=Te(".djs-palette-entries",this._container),this._toolsContainer=Te("[data-group=tools]",e)),it(this._toolsContainer.children,function(e){var n=e.getAttribute("data-action");if(n){var r=ve(e);n=n.replace("-tool",""),r.contains("entry")&&n===t?r.add("highlighted-entry"):r.remove("highlighted-entry")}})},xo.prototype.isOpen=function(){return ve(this._container).has("open")},xo.prototype._getParentContainer=function(){return this._canvas.getContainer()},xo.HTML_MARKUP='<div class="djs-palette"><div class="djs-palette-entries"></div><div class="djs-palette-toggle"></div></div>';var _o={__init__:["palette"],palette:["type",xo]},wo=Math.max,bo=Math.min,Eo=20;function So(t,e,n){var r=e[t],o=n.min&&n.min[t],i=n.max&&n.max[t];return J(o)&&(r=(/top|left/.test(t)?bo:wo)(r,o)),J(i)&&(r=(/top|left/.test(t)?wo:bo)(r,i)),r}function Co(t,e){return void 0!==t?t:Eo}function ko(t){return!t.waypoints&&"label"!==t.type}function jo(t,e){var n;if((n=void 0===t.length?ot(t.children,ko):t).length)return function(t,e){var n,r,o,i;return"object"==typeof e?(n=Co(e.left),r=Co(e.right),o=Co(e.top),i=Co(e.bottom)):n=r=o=i=Co(e),{x:t.x-n,y:t.y-o,width:t.width+n+r,height:t.height+o+i}}(jt(n),e)}function Mo(t,e,n,r){this._dragging=r,this._rules=e;var o=this;function i(t,e){var n,r=t.shape,i=t.direction,a=t.resizeConstraints;t.delta=e,n=function(t,e,n){var r=n.x,o=n.y;switch(e){case"nw":return{x:t.x+r,y:t.y+o,width:t.width-r,height:t.height-o};case"sw":return{x:t.x+r,y:t.y,width:t.width-r,height:t.height+o};case"ne":return{x:t.x,y:t.y+o,width:t.width+r,height:t.height-o};case"se":return{x:t.x,y:t.y,width:t.width+r,height:t.height+o};default:throw new Error("unrecognized direction: "+e)}}(r,i,e),t.newBounds=function(t,e){if(!e)return t;var n=Cn(t);return kn({top:So("top",n,e),right:So("right",n,e),bottom:So("bottom",n,e),left:So("left",n,e)})}(n,a),t.canExecute=o.canResize(t)}function a(t){var e,r=t.shape,o=t.canExecute,i=t.newBounds;if(o){if(e=i,!function(t,e){return t.x!==e.x||t.y!==e.y||t.width!==e.width||t.height!==e.height}(r,i={x:Math.round(e.x),y:Math.round(e.y),width:Math.round(e.width),height:Math.round(e.height)}))return;n.resizeShape(r,i)}}t.on("resize.start",function(t){var e,n,r;e=t.context,n=e.resizeConstraints,r=e.minBounds,void 0===n&&(void 0===r&&(r=o.computeMinResizeBox(e)),e.resizeConstraints={min:Cn(r)})}),t.on("resize.move",function(t){var e={x:t.dx,y:t.dy};i(t.context,e)}),t.on("resize.end",function(t){a(t.context)})}Mo.prototype.canResize=function(t){var e=this._rules,n=bt(t,["newBounds","shape","delta","direction"]);return e.allowed("shape.resize",n)},Mo.prototype.activate=function(t,e,n){var r,o,i=this._dragging;if("string"==typeof n&&(n={direction:n}),!(o=(r=wt({shape:e},n)).direction))throw new Error("must provide a direction (nw|se|ne|sw)");var a={x:/w/.test(o)?e.x:e.x+e.width,y:/n/.test(o)?e.y:e.y+e.height};i.init(t,a,"resize",{autoActivate:!0,cursor:"resize-"+(/nw|se/.test(o)?"nwse":"nesw"),data:{shape:e,context:r}})},Mo.prototype.computeMinResizeBox=function(t){var e=t.shape;return function(t,e,n,r){var o=Cn(e),i={top:/n/.test(t)?o.bottom-n.height:o.top,left:/w/.test(t)?o.right-n.width:o.left,bottom:/s/.test(t)?o.top+n.height:o.bottom,right:/e/.test(t)?o.left+n.width:o.right},a=r?Cn(r):i;return kn({top:bo(i.top,a.top),left:bo(i.left,a.left),bottom:wo(i.bottom,a.bottom),right:wo(i.right,a.right)})}(t.direction,e,t.minDimensions||{width:10,height:10},jo(e,t.childrenBoxPadding))},Mo.$inject=["eventBus","rules","modeling","dragging"];var Oo="djs-resizing",Po="resize-not-ok",Bo=500;function Ro(t,e,n){t.on("resize.move",Bo,function(t){var r,o,i,a;r=t.context,o=r.shape,i=r.newBounds,(a=r.frame)||(a=r.frame=n.addFrame(o,e.getDefaultLayer()),e.addMarker(o,Oo)),i.width>5&&S(a,{x:i.x,width:i.width}),i.height>5&&S(a,{y:i.y,height:i.height}),r.canExecute?O(a).remove(Po):O(a).add(Po)}),t.on("resize.cleanup",function(t){var n,r;n=t.context,r=n.shape,n.frame&&B(n.frame),e.removeMarker(r,Oo)})}Ro.$inject=["eventBus","canvas","previewSupport"];function Ao(t,e,n,r){this._resize=r,this._canvas=e;var o=this;t.on("selection.changed",function(t){var e=t.newSelection;o.removeResizers(),1===e.length&&it(e,xt(o.addResizer,o))}),t.on("shape.changed",function(t){var e=t.element;n.isSelected(e)&&(o.removeResizers(),o.addResizer(e))})}Ao.prototype.makeDraggable=function(t,e,n){var r=this._resize;function o(e){We(e)&&r.activate(e,t,n)}ke.bind(e,"mousedown",o),ke.bind(e,"touchstart",o)},Ao.prototype._createResizer=function(t,e,n,r,o){var i=this._getResizersParent(),a=L("g");O(a).add("djs-resizer"),O(a).add("djs-resizer-"+t.id),O(a).add("djs-resizer-"+o),_(i,a);var c=L("rect");S(c,{x:-7,y:-7,width:5,height:5}),O(c).add("djs-resizer-visual"),_(a,c);var s=L("rect");return S(s,{x:-7,y:-7,width:20,height:20}),O(s).add("djs-resizer-hit"),_(a,s),function(t,e,n,r,o){var i=F();i.setTranslate(e,n);var a=F();a.setRotate(r,0,0);var c=F();c.setScale(o||1,o||1),G(t,[i,a,c])}(a,e,n,r),a},Ao.prototype.createResizer=function(t,e){var n,r=Cn(t);n="nw"===e?this._createResizer(t,r.left,r.top,0,e):"ne"===e?this._createResizer(t,r.right,r.top,90,e):"se"===e?this._createResizer(t,r.right,r.bottom,180,e):this._createResizer(t,r.left,r.bottom,270,e),this.makeDraggable(t,n,e)},Ao.prototype.addResizer=function(t){this._resize.canResize({shape:t})&&(this.createResizer(t,"nw"),this.createResizer(t,"ne"),this.createResizer(t,"se"),this.createResizer(t,"sw"))},Ao.prototype.removeResizers=function(){R(this._getResizersParent())},Ao.prototype._getResizersParent=function(){return this._canvas.getLayer("resizers")},Ao.$inject=["eventBus","canvas","selection","resize"];var zo={__depends__:[un,En,Un],__init__:["resize","resizePreview","resizeHandles"],resize:["type",Mo],resizePreview:["type",Ro],resizeHandles:["type",Ao]};function To(t){return Math.log(t)/Math.log(10)}function $o(t,e){var n=To(t.min),r=To(t.max);return(Math.abs(n)+Math.abs(r))/e}var Lo=Math.sign||function(t){return t>=0?1:-1},Do={min:.2,max:4},No=.75;function Fo(t,e,n){t=t||{},this._enabled=!1,this._canvas=n,this._container=n._container,this._handleWheel=xt(this._handleWheel,this),this._totalDelta=0,this._scale=t.scale||No;var r=this;e.on("canvas.init",function(e){r._init(!1!==t.enabled)})}Fo.$inject=["config.zoomScroll","eventBus","canvas"],Fo.prototype.scroll=function(t){this._canvas.scroll(t)},Fo.prototype.reset=function(){this._canvas.zoom("fit-viewport")},Fo.prototype.zoom=function(t,e){var n=$o(Do,20);this._totalDelta+=t,Math.abs(this._totalDelta)>.1&&(this._zoom(t,e,n),this._totalDelta=0)},Fo.prototype._handleWheel=function(t){if(!be(t.target,".djs-scrollable",!0)){var e=this._container;t.preventDefault();var n,r=t.ctrlKey,o=t.shiftKey,i=-1*this._scale;if(i*=r?0===t.deltaMode?.02:.32:0===t.deltaMode?1:16,r){var a=e.getBoundingClientRect(),c={x:t.clientX-a.left,y:t.clientY-a.top};n=Math.sqrt(Math.pow(t.deltaY,2)+Math.pow(t.deltaX,2))*Lo(t.deltaY)*i,this.zoom(n,c)}else n=o?{dx:i*t.deltaY,dy:0}:{dx:i*t.deltaX,dy:i*t.deltaY},this.scroll(n)}},Fo.prototype.stepZoom=function(t,e){var n=$o(Do,10);this._zoom(t,e,n)},Fo.prototype._zoom=function(t,e,n){var r=this._canvas,o=t>0?1:-1,i=To(r.zoom()),a=Math.round(i/n)*n;a+=n*o;var c,s,u=Math.pow(10,a);r.zoom((c=Do,s=u,Math.max(c.min,Math.min(c.max,s))),e)},Fo.prototype.toggle=function(t){var e=this._container,n=this._handleWheel,r=this._enabled;return void 0===t&&(t=!r),r!==t&&ke[t?"bind":"unbind"](e,"wheel",n,!1),this._enabled=t,t},Fo.prototype._init=function(t){this.toggle(t)};var Ho={__init__:["zoomScroll"],zoomScroll:["type",Fo]};function Go(t,e,n){this._connect=t,this._modeling=n,e.registerProvider(this)}function Io(t,e,n,r){this._create=t,this._elementFactory=e,this._lassoTool=n,this._palette=r,r.registerProvider(this)}Go.$inject=["connect","contextPad","modeling"],Go.prototype.getContextPadEntries=function(t){var e=this._connect,n=this._modeling;function r(){n.removeElements([t])}function o(t,n,r){e.start(t,n,r)}return{delete:{group:"edit",className:"context-pad-icon-remove",title:"Remove",action:{click:r,dragstart:r}},connect:{group:"edit",className:"context-pad-icon-connect",title:"Connect",action:{click:o,dragstart:o}}}},Io.$inject=["create","elementFactory","lassoTool","palette"],Io.prototype.getPaletteEntries=function(){var t=this._create,e=this._elementFactory,n=this._lassoTool;return{"lasso-tool":{group:"tools",className:"palette-icon-lasso-tool",title:"Activate Lasso Tool",action:{click:function(t){n.activateSelection(t)}}},"tool-separator":{group:"tools",separator:!0},"create-shape":{group:"create",className:"palette-icon-create-shape",title:"Create Shape",action:{click:function(){var n=e.createShape({width:100,height:80});t.start(event,n)}}},"create-frame":{group:"create",className:"palette-icon-create-frame",title:"Create Frame",action:{click:function(){var n=e.createShape({width:300,height:200,isFrame:!0});t.start(event,n)}}}}};var Vo=n(3),qo=n.n(Vo);function Wo(t){this._eventBus=t}Wo.$inject=["eventBus"],Wo.prototype.on=function(t,e,n,r,o,i){if((tt(e)||J(e))&&(i=o,o=r,r=n,n=e,e=null),tt(n)&&(i=o,o=r,r=n,n=1e3),Q(o)&&(i=o,o=!1),!tt(r))throw new Error("handlerFn must be a function");Z(t)||(t=[t]);var a=this._eventBus;it(t,function(t){var c=["commandStack",t,e].filter(function(t){return t}).join(".");a.on(c,n,o?function(t,e){return function(n){return t.call(e||null,n.context,n.command,n)}}(r,i):r,i)})};function Uo(t){Wo.call(this,t),this.init()}function Yo(t){Uo.call(this,t)}it(["canExecute","preExecute","preExecuted","execute","executed","postExecute","postExecuted","revert","reverted"],function(t){Wo.prototype[t]=function(e,n,r,o,i){(tt(e)||J(e))&&(i=o,o=r,r=n,n=e,e=null),this.on(e,t,n,r,o,i)}}),Uo.$inject=["eventBus"],v()(Uo,Wo),Uo.prototype.addRule=function(t,e,n){var r=this;"string"==typeof t&&(t=[t]),t.forEach(function(t){r.canExecute(t,e,function(t,e,r){return n(t)},!0)})},Uo.prototype.init=function(){},Yo.$inject=["eventBus"],qo()(Yo,Uo),Yo.prototype.init=function(){this.addRule("shape.create",function(t){var e=t.target,n=t.shape;return e.parent===n.target}),this.addRule("connection.create",function(t){var e=t.source,n=t.target;return e.parent===n.parent}),this.addRule("shape.resize",function(t){return Ot(t.shape)})};var Ko={__init__:["exampleContextPadProvider","examplePaletteProvider","exampleRuleProvider"],exampleContextPadProvider:["type",Go],examplePaletteProvider:["type",Io],exampleRuleProvider:["type",Yo]},Xo=new He({canvas:{container:document.querySelector("#container")},modules:[zn,In,or,Ko,ur,eo,oo,mo,tn,_o,zo,un,cn,Ho]}),Zo=Xo.get("canvas"),Qo=Xo.get("defaultRenderer"),Jo=Xo.get("elementFactory"),ti=Xo.get("selection");Qo.CONNECTION_STYLE={fill:"none",strokeWidth:5,stroke:"#000"},Qo.SHAPE_STYLE={fill:"white",stroke:"#000",strokeWidth:2},Qo.FRAME_STYLE={fill:"none",stroke:"#000",strokeDasharray:4,strokeWidth:2};var ei=Jo.createRoot();Zo.setRootElement(ei);var ni=Jo.createShape({x:150,y:100,width:100,height:80});Zo.addShape(ni,ei);var ri=Jo.createShape({x:290,y:220,width:100,height:80});Zo.addShape(ri,ei);var oi=Jo.createConnection({waypoints:[{x:250,y:180},{x:290,y:220}],source:ni,target:ri});Zo.addConnection(oi,ei);var ii=Jo.createShape({x:450,y:80,width:100,height:80});Zo.addShape(ii,ei);var ai=Jo.createShape({x:425,y:50,width:300,height:200,isFrame:!0});Zo.addShape(ai,ei),ti.select(ii)}]);
//# sourceMappingURL=app.js.map